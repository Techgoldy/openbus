-- MySQL dump 10.13  Distrib 5.6.16, for Win32 (x86)
--
-- Host: localhost    Database: openbus
-- ------------------------------------------------------
-- Server version	5.6.16

/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8 */;
/*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */;
/*!40103 SET TIME_ZONE='+00:00' */;
/*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */;
/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */;
/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='NO_AUTO_VALUE_ON_ZERO' */;
/*!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 */;

--
-- Table structure for table `campos_origen`
--

DROP TABLE IF EXISTS `campos_origen`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `campos_origen` (
  `id` bigint(20) NOT NULL AUTO_INCREMENT,
  `nombre_campo` varchar(255) DEFAULT NULL,
  `orden_en_tabla` bigint(20) DEFAULT NULL,
  `tipo_campo` varchar(255) DEFAULT NULL,
  `version` int(11) DEFAULT NULL,
  `origen_estructurado` bigint(20) DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `FK_m5f8slvd12hmd0vson5a9w8sv` (`origen_estructurado`),
  CONSTRAINT `FK_m5f8slvd12hmd0vson5a9w8sv` FOREIGN KEY (`origen_estructurado`) REFERENCES `origen_estructurado` (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=89 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `campos_origen`
--

LOCK TABLES `campos_origen` WRITE;
/*!40000 ALTER TABLE `campos_origen` DISABLE KEYS */;
INSERT INTO `campos_origen` VALUES (1,'EVENTTIMESTAMP',1,'timestamp',NULL,1),(2,'SMTPDID',2,'int',NULL,1),(3,'MSGID',3,'string',NULL,1),(4,'CLEANUPID',4,'int',NULL,1),(5,'QMGRID',5,'int',NULL,1),(6,'SMTPID',6,'int',NULL,1),(7,'ERRORID',7,'int',NULL,1),(8,'CLIENTE',8,'string',NULL,1),(9,'CLIENTEIP',9,'string',NULL,1),(10,'ACCION',10,'string',NULL,1),(11,'SERVER',11,'string',NULL,1),(12,'SERVERIP',12,'string',NULL,1),(13,'MESSAGEID',13,'string',NULL,1),(14,'USERFROM',14,'string',NULL,1),(15,'SIZE',15,'int',NULL,1),(16,'NRCPT',16,'int',NULL,1),(17,'USERTO',17,'string',NULL,1),(18,'TOSERVERNAME',18,'string',NULL,1),(19,'TOSERVERIP',19,'string',NULL,1),(20,'TOSERVERPORT',20,'string',NULL,1),(21,'DELAY',21,'decimal',NULL,1),(22,'DSN',22,'string',NULL,1),(23,'STATUS',23,'string',NULL,1),(24,'STATUSDESC',24,'string',NULL,1),(25,'AMAVISID',25,'string',NULL,1),(26,'EVENTTIMESTAMP',1,'timestamp',NULL,2),(27,'TIMETAKEN',2,'int',NULL,2),(28,'MSGID',3,'string',NULL,2),(29,'CLIENTIP',4,'string',NULL,2),(30,'USERCODE',5,'string',NULL,2),(31,'USERGROUP',6,'string',NULL,2),(32,'EXCEPTION',7,'string',NULL,2),(33,'FILTERRESULT',8,'string',NULL,2),(34,'CATEGORY',9,'string',NULL,2),(35,'REFERER',10,'string',NULL,2),(36,'RESPONSECODE',11,'int',NULL,2),(37,'ACTION',12,'string',NULL,2),(38,'METHOD',13,'string',NULL,2),(39,'CONTENTTYPE',14,'string',NULL,2),(40,'PROTOCOL',15,'string',NULL,2),(41,'REQUESTDOMAIN',16,'string',NULL,2),(42,'REQUESTPORT',17,'int',NULL,2),(43,'REQUESTPATH',18,'string',NULL,2),(44,'REQUESTQUERY',19,'string',NULL,2),(45,'REQUESTURIEXCEPTION',20,'string',NULL,2),(46,'USERAGENT',21,'string',NULL,2),(47,'SERVERIP',22,'string',NULL,2),(48,'SCBYTES',23,'int',NULL,2),(49,'CSBYTES',24,'int',NULL,2),(50,'VIRUSID',25,'string',NULL,2),(51,'DESTINATIONIP',26,'string',NULL,2),(52,'EVENTTIMESTAMP_SESION',1,'timestamp',NULL,4),(53,'ICID',2,'int',NULL,4),(54,'MID',3,'int',NULL,4),(55,'RID',4,'int',NULL,4),(56,'DCID',5,'int',NULL,4),(57,'SUBJECT',6,'string',NULL,4),(58,'MAILFROM',7,'string',NULL,4),(59,'MAILTO',8,'string',NULL,4),(60,'RESPONSE',9,'string',NULL,4),(61,'BYTES',10,'int',NULL,4),(62,'INTERFACE',11,'string',NULL,4),(63,'PUERTO',12,'int',NULL,4),(64,'INTERFACEIP',13,'string',NULL,4),(65,'HOSTIP',14,'string',NULL,4),(66,'HOSTNAME',15,'string',NULL,4),(67,'HOSTVERIFIED',16,'string',NULL,4),(68,'DSNBOUNCE',17,'string',NULL,4),(69,'BOUNCEDESC',18,'string',NULL,4),(70,'SPAMCASE',19,'string',NULL,4),(71,'DCIDDELAY',20,'int',NULL,4),(72,'MIDDELAY',21,'int',NULL,4),(73,'RIDDELAY',22,'int',NULL,4),(74,'DSNDELAY',23,'string',NULL,4),(75,'DELAYDESC',24,'string',NULL,4),(76,'ANTIVIRUS',25,'string',NULL,4),(77,'REPUTATION',26,'string',NULL,4),(78,'RANGO',27,'string',NULL,4),(79,'SCORE',28,'string',NULL,4),(80,'FILTROCONTENIDO',29,'string',NULL,4),(81,'MARKETINGCASE',30,'string',NULL,4),(82,'ID_SESION',1,'string',NULL,5),(83,'CLIENTIP',2,'string',NULL,5),(84,'USERCODE',3,'string',NULL,5),(85,'EVENTTIMESTAMP_SESION',4,'timestamp',NULL,5),(86,'SECUENCIAPETICION',5,'int',NULL,5),(87,'EVENTTIMESTAMP_PETICION',6,'timestamp',NULL,5),(88,'RECURSO',7,'string',NULL,5);
/*!40000 ALTER TABLE `campos_origen` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `metrica_batch`
--

DROP TABLE IF EXISTS `metrica_batch`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `metrica_batch` (
  `id` bigint(20) NOT NULL AUTO_INCREMENT,
  `from_query` varchar(255) DEFAULT NULL,
  `where_query` longblob,
  `batch_metric_desc` varchar(255) DEFAULT NULL,
  `batch_metric_name` varchar(255) DEFAULT NULL,
  `create_code` longblob,
  `error` longblob,
  `es_campos_id` varchar(255) DEFAULT NULL,
  `es_id` varchar(255) DEFAULT NULL,
  `es_index` varchar(255) DEFAULT NULL,
  `es_timestamp` varchar(255) DEFAULT NULL,
  `es_type` varchar(255) DEFAULT NULL,
  `estado` varchar(255) DEFAULT NULL,
  `fecha_creacion` datetime DEFAULT NULL,
  `fecha_ult_modif` datetime DEFAULT NULL,
  `is_batch` bit(1) DEFAULT NULL,
  `is_created` bit(1) DEFAULT NULL,
  `is_updated` bit(1) DEFAULT NULL,
  `planificacion` varchar(255) DEFAULT NULL,
  `query_code` longblob,
  `select_query` longblob,
  `source_id` varchar(255) DEFAULT NULL,
  `type_query` varchar(255) DEFAULT NULL,
  `usuario_creacion` varchar(255) DEFAULT NULL,
  `usuario_modificacion` varchar(255) DEFAULT NULL,
  `version` int(11) DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `metrica_batch`
--

LOCK TABLES `metrica_batch` WRITE;
/*!40000 ALTER TABLE `metrica_batch` DISABLE KEYS */;
INSERT INTO `metrica_batch` VALUES (1,'FROM ob_src_postfix','where MSGID is not NULL and QMGRID is not NULL and USERFROM !=\'null\' GROUP BY MONTH(eventTimeStamp), YEAR(eventTimeStamp)','Primer y ultimo correo por cada mes','primult_correo',NULL,NULL,'ID','','ob_src_postfix','eventtimestamp','primult_correo','Ok','2014-07-28 17:07:23','2014-08-04 14:28:30','','','','','INSERT OVERWRITE TABLE primult_correo SELECT\nCONCAT(YEAR(eventTimeStamp),MONTH(eventTimeStamp)) as ID,\nMONTH(eventTimeStamp) as MES,\nYEAR(eventTimeStamp) as ANO,\nMAX(eventTimeStamp) as  ULTIMO,\nMIN(eventTimeStamp) as PRIMERO FROM ob_src_postfix where MSGID is not NULL and QMGRID is not NULL and USERFROM !=\'null\' GROUP BY MONTH(eventTimeStamp), YEAR(eventTimeStamp)','SELECT\nCONCAT(YEAR(eventTimeStamp),MONTH(eventTimeStamp)) as ID,\nMONTH(eventTimeStamp) as MES,\nYEAR(eventTimeStamp) as ANO,\nMAX(eventTimeStamp) as  ULTIMO,\nMIN(eventTimeStamp) as PRIMERO','1','ID STRING,\nMES INT,ANO INT,\nULTIMO STRING,PRIMERO STRING',NULL,NULL,6),(2,'FROM ob_src_postfix','WHERE QMGRID is not NULL and SIZE is not NULL\nGROUP BY MSGID)tam\nON tam.MSGID=correo.MSGID\nGROUP BY MES,ANO','Correos Ok por mes','correos_ok',NULL,NULL,'ID','','ob_src_postfix','eventtimestamp','correos_ok','Ok','2014-07-28 17:16:56','2014-07-29 16:38:55','','','','','INSERT OVERWRITE TABLE correos_ok SELECT\nCONCAT(ANO,MES) as ID,\nMES,\nANO,\nSUM(TAMANO*cuenta) TAMANO_ok,\nsum(cuenta) as CUENTA_OK\nFROM\n(\nSELECT\nMSGID,\nMONTH(eventTimeStamp) as MES,\nYEAR(eventTimeStamp) as ANO,\ncount(1) as cuenta\nFROM ob_src_postfix\nWHERE DSN in(\"2.0.0\",\"2.6.0\",\"2.4.0\") and AMAVISID =\'null\' group by MSGID,MONTH(eventTimeStamp),YEAR(eventTimeStamp)) correo\nJOIN\n(SELECT\nMSGID,\nSUM(SIZE) as TAMANO FROM ob_src_postfix WHERE QMGRID is not NULL and SIZE is not NULL\nGROUP BY MSGID)tam\nON tam.MSGID=correo.MSGID\nGROUP BY MES,ANO','SELECT\nCONCAT(ANO,MES) as ID,\nMES,\nANO,\nSUM(TAMANO*cuenta) TAMANO_ok,\nsum(cuenta) as CUENTA_OK\nFROM\n(\nSELECT\nMSGID,\nMONTH(eventTimeStamp) as MES,\nYEAR(eventTimeStamp) as ANO,\ncount(1) as cuenta\nFROM ob_src_postfix\nWHERE DSN in(\"2.0.0\",\"2.6.0\",\"2.4.0\") and AMAVISID =\'null\' group by MSGID,MONTH(eventTimeStamp),YEAR(eventTimeStamp)) correo\nJOIN\n(SELECT\nMSGID,\nSUM(SIZE) as TAMANO','1','ID STRING,\nMES INT, ANO INT,\nTAMANO_OK BIGINT, CUENTA_OK BIGINT','admin',NULL,6),(8,'FROM ob_src_postfix','WHERE DSN not in(\"2.0.0\",\"2.6.0\",\"2.4.0\",\"null\") and AMAVISID =\'null\' group by MSGID,MONTH(eventTimeStamp),YEAR(eventTimeStamp)) correo\nJOIN\n(SELECT\nMSGID,\nSUM(SIZE) as TAMANO\nFROM ssss\nWHERE QMGRID is not NULL and SIZE is not NULL\nGROUP BY MSGID)tam\nON tam.MSGID=correo.MSGID\nGROUP BY MES,ANO','Correos err√≥neos o devueltos','correos_notok',NULL,'java.sql.SQLException: Error while compiling statement: FAILED: SemanticException [Error 10001]: Line 18:5 Table not found \'ob_src_postfix1\'','ID','','ob_src_postfix','','correos_notok','Ok','2014-07-29 10:26:24','2014-07-29 10:34:02','','',NULL,'','INSERT OVERWRITE TABLE correos_notok SELECT\nCONCAT(ANO,MES) as ID,\nMES,\nANO,\nSUM(TAMANO*cuenta) TAMANO_notok,\nsum(cuenta) as CUENTA_NOTOK\nFROM\n(\nSELECT\nMSGID,\nMONTH(eventTimeStamp) as MES,\nYEAR(eventTimeStamp) as ANO,\ncount(1) as cuenta FROM ob_src_postfix WHERE DSN not in(\"2.0.0\",\"2.6.0\",\"2.4.0\",\"null\") and AMAVISID =\'null\' group by MSGID,MONTH(eventTimeStamp),YEAR(eventTimeStamp)) correo\nJOIN\n(SELECT\nMSGID,\nSUM(SIZE) as TAMANO\nFROM ob_src_postfix\nWHERE QMGRID is not NULL and SIZE is not NULL\nGROUP BY MSGID)tam\nON tam.MSGID=correo.MSGID\nGROUP BY MES,ANO','SELECT\nCONCAT(ANO,MES) as ID,\nMES,\nANO,\nSUM(TAMANO*cuenta) TAMANO_notok,\nsum(cuenta) as CUENTA_NOTOK\nFROM\n(\nSELECT\nMSGID,\nMONTH(eventTimeStamp) as MES,\nYEAR(eventTimeStamp) as ANO,\ncount(1) as cuenta','1','ID STRING,\nMES BIGINT,\nANO BIGINT,\nTAMANO_notok BIGINT,\nCUENTA_NOTOK BIGINT',NULL,NULL,4),(9,'FROM ob_src_postfix','WHERE DSN in(\"2.0.0\",\"2.6.0\",\"2.4.0\") and AMAVISID =\'null\' group by MSGID,DAY(eventTimeStamp) ,MONTH(eventTimeStamp),YEAR(eventTimeStamp)) correo\nJOIN\n(SELECT\nMSGID,\nSUM(SIZE) as TAMANO\nFROM POSTFIX_LOGS\nWHERE QMGRID is not NULL and SIZE is not NULL\nGROUP BY MSGID)tam\nON tam.MSGID=correo.MSGID\nGROUP BY DIA,MES,ANO;\n','Cantidad de correos OK por d√≠a','correos_diaok',NULL,'java.sql.SQLException: Error while compiling statement: FAILED: SemanticException [Error 10001]: Line 20:5 Table not found \'POSTFIX_LOGS\'','ID','','ob_src_postfix','','correos_diaok','Ok','2014-07-29 10:39:58','2014-07-29 10:47:28','','',NULL,'','INSERT OVERWRITE TABLE correos_diaok SELECT\nCONCAT(ANO,\"/\",MES,\"/\",DIA) as ID,\nDIA,\nMES,\nANO,\nSUM(TAMANO*cuenta) TAMANO_ok,\nsum(cuenta) as CUENTA_OK\nFROM\n(\nSELECT\nMSGID,\nDAY(eventTimeStamp) as DIA,\nMONTH(eventTimeStamp) as MES,\nYEAR(eventTimeStamp) as ANO,\ncount(1) as cuenta FROM ob_src_postfix WHERE DSN in(\"2.0.0\",\"2.6.0\",\"2.4.0\") and AMAVISID =\'null\' group by MSGID,DAY(eventTimeStamp) ,MONTH(eventTimeStamp),YEAR(eventTimeStamp)) correo\nJOIN\n(SELECT\nMSGID,\nSUM(SIZE) as TAMANO\nFROM ob_src_postfix\nWHERE QMGRID is not NULL and SIZE is not NULL\nGROUP BY MSGID)tam\nON tam.MSGID=correo.MSGID\nGROUP BY DIA,MES,ANO','SELECT\nCONCAT(ANO,\"/\",MES,\"/\",DIA) as ID,\nDIA,\nMES,\nANO,\nSUM(TAMANO*cuenta) TAMANO_ok,\nsum(cuenta) as CUENTA_OK\nFROM\n(\nSELECT\nMSGID,\nDAY(eventTimeStamp) as DIA,\nMONTH(eventTimeStamp) as MES,\nYEAR(eventTimeStamp) as ANO,\ncount(1) as cuenta','1','ID STRING,\nDIA BIGINT,\nMES BIGINT,\nANO BIGINT,\nTAMANO_ok BIGINT,\nCUENTA_OK BIGINT','anonymousUser',NULL,4),(10,'FROM ob_src_postfix','WHERE DSN in(\"2.0.0\",\"2.6.0\",\"2.4.0\") and AMAVISID =\'null\'\nGROUP BY MSGID) DES\nJOIN\n(\nSELECT\nMSGID,\nUSERFROM,\nsum(SIZE) as TAMANO_enviados,\nMAX(eventTimeStamp) as ULTIMO,\nMONTH(eventTimeStamp) as MES,\nYEAR(eventTimeStamp) as ANO \nFROM ob_src_postfix\nWHERE SIZE is not NULL\nGROUP BY MSGID, USERFROM, MONTH(eventTimeStamp) ,YEAR(eventTimeStamp)  \n) REM\nON REM.MSGID=DES.MSGID\nGROUP BY USERFROM, MES,ANO','Correos enviados por emisor y mes','top_emisores',NULL,NULL,'ID','','ob_src_postfix','','top_emisores','Ok','2014-07-29 10:56:53','2014-07-29 10:59:58','','',NULL,'','INSERT OVERWRITE TABLE top_emisores SELECT\nCONCAT(ANO,MES,\"-\",USERFROM) as ID,\nUSERFROM,\ncount(CUENTA) as CUENTA,\nsum(TAMANO_enviados) as TAMANO,\nMAX(ULTIMO) as ULTIMO,\nMES,ANO\nFROM\n(SELECT\nMSGID,\ncount(1) as CUENTA FROM ob_src_postfix WHERE DSN in(\"2.0.0\",\"2.6.0\",\"2.4.0\") and AMAVISID =\'null\'\nGROUP BY MSGID) DES\nJOIN\n(\nSELECT\nMSGID,\nUSERFROM,\nsum(SIZE) as TAMANO_enviados,\nMAX(eventTimeStamp) as ULTIMO,\nMONTH(eventTimeStamp) as MES,\nYEAR(eventTimeStamp) as ANO \nFROM ob_src_postfix\nWHERE SIZE is not NULL\nGROUP BY MSGID, USERFROM, MONTH(eventTimeStamp) ,YEAR(eventTimeStamp)  \n) REM\nON REM.MSGID=DES.MSGID\nGROUP BY USERFROM, MES,ANO','SELECT\nCONCAT(ANO,MES,\"-\",USERFROM) as ID,\nUSERFROM,\ncount(CUENTA) as CUENTA,\nsum(TAMANO_enviados) as TAMANO,\nMAX(ULTIMO) as ULTIMO,\nMES,ANO\nFROM\n(SELECT\nMSGID,\ncount(1) as CUENTA','1','ID STRING,\nUSERFROM STRING,\nCUENTA BIGINT,\nTAMANO BIGINT,\nULTIMO TIMESTAMP,\nMES BIGINT,ANO BIGINT','anonymousUser',NULL,2),(11,'FROM ob_src_postfix','WHERE DSN in(\"2.0.0\",\"2.6.0\",\"2.4.0\") and AMAVISID =\'null\'\nGROUP BY MSGID,USERTO, MONTH(eventTimeStamp) ,YEAR(eventTimeStamp)  \n) DES\nJOIN\n(\nSELECT\nMSGID,\nsum(SIZE) as TAMANO_enviados\nFROM ob_src_postfix\nWHERE SIZE is not NULL\nGROUP BY MSGID\n) REM\nON REM.MSGID=DES.MSGID\nGROUP BY USERTO, MES,ANO','Cantidad de correos por receptor y mes','top_receptores',NULL,NULL,'ID','','ob_src_postfix','','top_receptores','Ok','2014-07-29 11:04:25','2014-07-29 11:07:17','','',NULL,'','INSERT OVERWRITE TABLE top_receptores SELECT\nCONCAT(ANO,MES,\"-\",USERTO) as ID,\nUSERTO,\ncount(1) as CUENTA,\nsum(TAMANO_enviados) as TAMANO,\nMAX(ULTIMO) as ULTIMO,\nMES,ANO\nFROM\n(SELECT\nMSGID,USERTO,MAX(eventTimeStamp) as ULTIMO,\nMONTH(eventTimeStamp) as MES,\nYEAR(eventTimeStamp) as ANO  FROM ob_src_postfix WHERE DSN in(\"2.0.0\",\"2.6.0\",\"2.4.0\") and AMAVISID =\'null\'\nGROUP BY MSGID,USERTO, MONTH(eventTimeStamp) ,YEAR(eventTimeStamp)  \n) DES\nJOIN\n(\nSELECT\nMSGID,\nsum(SIZE) as TAMANO_enviados\nFROM ob_src_postfix\nWHERE SIZE is not NULL\nGROUP BY MSGID\n) REM\nON REM.MSGID=DES.MSGID\nGROUP BY USERTO, MES,ANO','SELECT\nCONCAT(ANO,MES,\"-\",USERTO) as ID,\nUSERTO,\ncount(1) as CUENTA,\nsum(TAMANO_enviados) as TAMANO,\nMAX(ULTIMO) as ULTIMO,\nMES,ANO\nFROM\n(SELECT\nMSGID,USERTO,MAX(eventTimeStamp) as ULTIMO,\nMONTH(eventTimeStamp) as MES,\nYEAR(eventTimeStamp) as ANO ','1','ID STRING,\nUSERTO STRING,CUENTA BIGINT,\nTAMANO BIGINT,\nULTIMO TIMESTAMP,\nMES BIGINT,ANO BIGINT','anonymousUser',NULL,2),(17,'FROM ob_src_postfix','WHERE DSN not in (\"2.0.0\",\"2.6.0\",\"2.4.0\",\"null\")\nGROUP BY MSGID,DSN, MONTH(eventTimeStamp), YEAR(eventTimeStamp)\n) ERR\nJOIN\n(\nSELECT\nMSGID,\nsum(SIZE) as TAMANO\nFROM ob_src_postfix\nWHERE SIZE is not NULL\nGROUP BY MSGID\n)TAM\nON TAM.MSGID=ERR.MSGID\nJOIN\n(\nSELECT\ncount(1) as total,\nMONTH(eventTimeStamp) as MES,\nYEAR(eventTimeStamp) as ANO\nFROM ob_src_postfix\nWHERE DSN not in (\"2.0.0\",\"2.6.0\",\"2.4.0\",\"null\")\nGROUP BY MONTH(eventTimeStamp) ,YEAR(eventTimeStamp) \n)TOT\nON TOT.ANO=ERR.ANO AND TOT.MES=ERR.MES\nGROUP BY ERR.DSN,ERR.MES,ERR.ANO,TOTALes','Correos con error por mes','errores_smtp','CREATE EXTERNAL TABLE errores_smtp(ID STRING,\nDSN STRING,\ncuenta BIGINT,\ntamano BIGINT,\nporcentaje BIGINT,\nMES BIGINT, ANO BIGINT) STORED BY \'org.elasticsearch.hadoop.hive.EsStorageHandler\' TBLPROPERTIES(\'es.resource\' = \'ob_src_postfix/errores_smtp\', \'es.mapping.id\' = \'ID\', \'es.id.field\' = \'ID\', \'es.index.auto.create\' = \'true\',\'es.nodes\' = \'180.133.240.42,180.133.240.43,180.133.240.44\', \'es.port\' = \'9200\')','java.sql.SQLException: Error while compiling statement: FAILED: SemanticException [Error 10004]: Line 39:33 Invalid table alias or column reference \'TOTALes\': (possible column names are: err.msgid, err.dsn, err.correos, err.mes, err.ano, tam.msgid, tam.tamano, tot.total, tot.mes, tot.ano)','ID','','ob_src_postfix','','errores_smtp','Ok','2014-07-29 12:00:57','2014-07-29 12:22:22','','','','','INSERT OVERWRITE TABLE errores_smtp SELECT \nCONCAT(ERR.ANO,ERR.MES,\"-\",ERR.DSN) as ID,\nERR.DSN,\nsum(correos) as correos,\n(sum(correos)*100)/total as porcentaje,\nsum(TAMANO) as TAMANO,\nERR.MES,\nERR.ANO\nFROM\n(SELECT\nMSGID,\nDSN,\ncount(1) as correos,\nMONTH(eventTimeStamp) as MES,\nYEAR(eventTimeStamp) as ANO FROM ob_src_postfix WHERE DSN not in (\"2.0.0\",\"2.6.0\",\"2.4.0\",\"null\")\nGROUP BY MSGID,DSN, MONTH(eventTimeStamp), YEAR(eventTimeStamp)\n) ERR\nJOIN\n(\nSELECT\nMSGID,\nsum(SIZE) as TAMANO\nFROM ob_src_postfix\nWHERE SIZE is not NULL\nGROUP BY MSGID\n)TAM\nON TAM.MSGID=ERR.MSGID\nJOIN\n(\nSELECT\ncount(1) as total,\nMONTH(eventTimeStamp) as MES,\nYEAR(eventTimeStamp) as ANO\nFROM ob_src_postfix\nWHERE DSN not in (\"2.0.0\",\"2.6.0\",\"2.4.0\",\"null\")\nGROUP BY MONTH(eventTimeStamp) ,YEAR(eventTimeStamp) \n)TOT\nON TOT.ANO=ERR.ANO AND TOT.MES=ERR.MES\nGROUP BY ERR.DSN,ERR.MES,ERR.ANO,TOTAL','SELECT \nCONCAT(ERR.ANO,ERR.MES,\"-\",ERR.DSN) as ID,\nERR.DSN,\nsum(correos) as correos,\n(sum(correos)*100)/total as porcentaje,\nsum(TAMANO) as TAMANO,\nERR.MES,\nERR.ANO\nFROM\n(SELECT\nMSGID,\nDSN,\ncount(1) as correos,\nMONTH(eventTimeStamp) as MES,\nYEAR(eventTimeStamp) as ANO','1','ID STRING,\nDSN STRING,\ncuenta BIGINT,\ntamano BIGINT,\nporcentaje BIGINT,\nMES BIGINT, ANO BIGINT',NULL,NULL,9),(18,'FROM ob_src_postfix','WHERE SMTPDID is not null and MSGID!= \'null\' and CLIENTEIP!=\'null\') EMI\nJOIN\n(\nSELECT\nMSGID,\nAMAVISID\nFROM ob_src_postfix\nWHERE SMTPID is not null and AMAVISID != \'null\' and DSN in(\"2.0.0\",\"2.6.0\",\"2.4.0\")\nGROUP BY MSGID, AMAVISID\n) ENV\nON ENV.MSGID=EMI.MSGID\nJOIN\n(\nSELECT\nMSGID as AMAVISID,\nCONCAT(TOSERVERNAME,\'[\',TOSERVERIP,\']\') as SERVDESTINO\nFROM ob_src_postfix\nWHERE SMTPID is not null and AMAVISID = \'null\' and DSN in(\"2.0.0\",\"2.6.0\",\"2.4.0\")\n) REC\nON ENV.AMAVISID=REC.AMAVISID','Correos enviados entre servidores','envio_entre_servidores','CREATE EXTERNAL TABLE envio_entre_servidores(ID STRING,\nMSGID STRING,\nAMAVISID STRING,\nSERVORIGEN STRING,\nSERVDESTINO STRING,\neventTimeStamp timestamp) STORED BY \'org.elasticsearch.hadoop.hive.EsStorageHandler\' TBLPROPERTIES(\'es.resource\' = \'ob_src_postfix/envio_entre_servidores\', \'es.mapping.id\' = \'ID\', \'es.id.field\' = \'ID\', \'es.index.auto.create\' = \'true\',\'es.nodes\' = \'180.133.240.42,180.133.240.43,180.133.240.44\', \'es.port\' = \'9200\', \'es.mapping.names\' = \'eventtimestamp:@timestamp\')','java.sql.SQLException: Error while compiling statement: FAILED: SemanticException [Error 10002]: Line 31:20 Invalid column reference \'AMAVISIDd\'','ID','','ob_src_postfix','eventtimestamp','envio_entre_servidores','Ok','2014-07-29 12:58:12','2014-07-30 16:51:50','','','','','INSERT OVERWRITE TABLE envio_entre_servidores SELECT\nCONCAT(eventTimeStamp,\'-\',EMI.MSGID) as ID,\nEMI.MSGID,\nREc.AMAVISID,\nSERVORIGEN,\nSERVDESTINO,\neventTimeStamp\nFROM\n(SELECT\nMSGID,\nCONCAT(CLIENTE,\'[\',CLIENTEIP,\']\') as SERVORIGEN,\neventTimeStamp FROM ob_src_postfix WHERE SMTPDID is not null and MSGID!= \'null\' and CLIENTEIP!=\'null\') EMI\nJOIN\n(\nSELECT\nMSGID,\nAMAVISID\nFROM ob_src_postfix\nWHERE SMTPID is not null and AMAVISID != \'null\' and DSN in(\"2.0.0\",\"2.6.0\",\"2.4.0\")\nGROUP BY MSGID, AMAVISID\n) ENV\nON ENV.MSGID=EMI.MSGID\nJOIN\n(\nSELECT\nMSGID as AMAVISID,\nCONCAT(TOSERVERNAME,\'[\',TOSERVERIP,\']\') as SERVDESTINO\nFROM ob_src_postfix\nWHERE SMTPID is not null and AMAVISID = \'null\' and DSN in(\"2.0.0\",\"2.6.0\",\"2.4.0\")\n) REC\nON ENV.AMAVISID=REC.AMAVISID','SELECT\nCONCAT(eventTimeStamp,\'-\',EMI.MSGID) as ID,\nEMI.MSGID,\nREc.AMAVISID,\nSERVORIGEN,\nSERVDESTINO,\neventTimeStamp\nFROM\n(SELECT\nMSGID,\nCONCAT(CLIENTE,\'[\',CLIENTEIP,\']\') as SERVORIGEN,\neventTimeStamp','1','ID STRING,\nMSGID STRING,\nAMAVISID STRING,\nSERVORIGEN STRING,\nSERVDESTINO STRING,\neventTimeStamp timestamp',NULL,NULL,6),(19,'FROM ob_src_bluecoat','WHERE eventTimeStamp>\"2014-07-29 10:00:00\" and eventTimeStamp<=\"2014-07-30 10:00:00\"\nGROUP BY eventTimeStamp,usercode','peticiones proxy por usuario','peticiones_usuario','CREATE EXTERNAL TABLE peticiones_usuario(ID STRING,\nuserCode STRING,\neventTimeStamp timestamp,\npeticiones BIGINT) STORED BY \'org.elasticsearch.hadoop.hive.EsStorageHandler\' TBLPROPERTIES(\'es.resource\' = \'ob_src_bluecoat/peticiones_usuario\', \'es.mapping.id\' = \'ID\', \'es.id.field\' = \'ID\', \'es.index.auto.create\' = \'true\',\'es.nodes\' = \'180.133.240.42,180.133.240.43,180.133.240.44\', \'es.port\' = \'9200\', \'es.mapping.names\' = \'eventtimestamp:@timestamp\')','java.sql.SQLException: Error while processing statement: FAILED: Execution Error, return code 2 from org.apache.hadoop.hive.ql.exec.mr.MapRedTask','ID','','ob_src_bluecoat','eventtimestamp','peticiones_usuario','Ok','2014-07-29 13:19:36','2014-07-31 09:17:12','','','','','INSERT OVERWRITE TABLE peticiones_usuario SELECT\nCONCAT(eventTimeStamp,\"-\",userCode) as ID,\nuserCode,\neventTimeStamp,\nCount(1) as peticiones FROM ob_src_bluecoat WHERE eventTimeStamp>\"2014-07-29 10:00:00\" and eventTimeStamp<=\"2014-07-30 10:00:00\"\nGROUP BY eventTimeStamp,usercode','SELECT\nCONCAT(eventTimeStamp,\"-\",userCode) as ID,\nuserCode,\neventTimeStamp,\nCount(1) as peticiones','4','ID STRING,\nuserCode STRING,\neventTimeStamp timestamp,\npeticiones BIGINT','admin',NULL,12),(20,'FROM ob_src_bluecoat','WHERE eventTimeStamp>\"2014-07-26 22:00:00\"\nAND eventTimeStamp <=\"2014-07-27 10:00:00\"\nGROUP BY eventTimeStamp,usercode,requestDomain','peticiones de dominios por usuario','peticiones_dominio_usuario','CREATE EXTERNAL TABLE peticiones_dominio_usuario(ID STRING,\nusuario_dominio STRING,\nuserCode STRING,\nrequestDomain STRING,\neventTimeStamp timestamp,\npeticiones BIGINT) STORED BY \'org.elasticsearch.hadoop.hive.EsStorageHandler\' TBLPROPERTIES(\'es.resource\' = \'ob_src_bluecoat/peticiones_dominio_usuario\', \'es.mapping.id\' = \'ID\', \'es.id.field\' = \'ID\', \'es.index.auto.create\' = \'true\',\'es.nodes\' = \'180.133.240.42,180.133.240.43,180.133.240.44\', \'es.port\' = \'9200\', \'es.mapping.names\' = \'eventtimestamp:@timestamp\')','java.sql.SQLException: Error while processing statement: FAILED: Execution Error, return code 2 from org.apache.hadoop.hive.ql.exec.mr.MapRedTask','ID','','ob_src_bluecoat','eventtimestamp','peticiones_dominio_usuario','Ok','2014-07-29 13:52:23','2014-07-31 09:33:28','','','','','INSERT OVERWRITE TABLE peticiones_dominio_usuario SELECT\nCONCAT(eventTimeStamp,\"-\",requestDomain,\"-\",userCode) as ID,\nCONCAT(requestDomain,\"-\",usercode) as usuario_dominio,\nuserCode,\nrequestDomain,\neventTimeStamp,\nCount(1) as peticiones FROM ob_src_bluecoat WHERE eventTimeStamp>\"2014-07-26 22:00:00\"\nAND eventTimeStamp <=\"2014-07-27 10:00:00\"\nGROUP BY eventTimeStamp,usercode,requestDomain','SELECT\nCONCAT(eventTimeStamp,\"-\",requestDomain,\"-\",userCode) as ID,\nCONCAT(requestDomain,\"-\",usercode) as usuario_dominio,\nuserCode,\nrequestDomain,\neventTimeStamp,\nCount(1) as peticiones','4','ID STRING,\nusuario_dominio STRING,\nuserCode STRING,\nrequestDomain STRING,\neventTimeStamp timestamp,\npeticiones BIGINT','admin',NULL,14),(21,'FROM ob_src_bluecoat','WHERE eventtimestamp>\"2014-07-25 10:00:00\" and eventtimestamp<=\"2014-07-25 22:00:00\"\nGROUP BY eventTimeStamp,usercode,clientIP','Cantidad de peticiones por usuario y m√°quina','peticiones_usuario_maquina','CREATE EXTERNAL TABLE peticiones_usuario_maquina(ID STRING,\nusuario_maquina STRING,\nuserCode STRING,\nclientIP STRING,\neventTimeStamp timestamp,\npeticiones BIGINT) STORED BY \'org.elasticsearch.hadoop.hive.EsStorageHandler\' TBLPROPERTIES(\'es.resource\' = \'ob_src_bluecoat/peticiones_usuario_maquina\', \'es.mapping.id\' = \'ID\', \'es.id.field\' = \'ID\', \'es.index.auto.create\' = \'true\',\'es.nodes\' = \'180.133.240.42,180.133.240.43,180.133.240.44\', \'es.port\' = \'9200\', \'es.mapping.names\' = \'eventtimestamp:@timestamp\')',NULL,'ID','','ob_src_bluecoat','eventtimestamp','peticiones_usuario_maquina','Ok','2014-07-29 14:43:41','2014-07-29 14:43:41','','',NULL,'','INSERT OVERWRITE TABLE peticiones_usuario_maquina SELECT\nCONCAT(eventTimeStamp,\"-\",clientIP,\"-\",userCode) as ID,\nCONCAT(clientIP,\"-\",usercode) as usuario_maquina,\nuserCode,\nclientIP,\neventTimeStamp,\nCount(1) as peticiones FROM ob_src_bluecoat WHERE eventtimestamp>\"2014-07-25 10:00:00\" and eventtimestamp<=\"2014-07-25 22:00:00\"\nGROUP BY eventTimeStamp,usercode,clientIP','SELECT\nCONCAT(eventTimeStamp,\"-\",clientIP,\"-\",userCode) as ID,\nCONCAT(clientIP,\"-\",usercode) as usuario_maquina,\nuserCode,\nclientIP,\neventTimeStamp,\nCount(1) as peticiones','4','ID STRING,\nusuario_maquina STRING,\nuserCode STRING,\nclientIP STRING,\neventTimeStamp timestamp,\npeticiones BIGINT',NULL,NULL,2),(22,'FROM ob_src_bluecoat','WHERE requestURIExtension not in (\"html\", \"htm\", \"-\", \"php\") AND eventtimestamp>\"2014-07-25 10:00:00\" AND eventtimestamp<=\"2014-07-25 22:00:00\"\nGROUP BY eventTimeStamp,requestDomain','Cantidad de descargas por dominio','descarga_dominio','CREATE EXTERNAL TABLE descarga_dominio(ID STRING,\nrequestDomain STRING,\neventTimeStamp timestamp,\ndescargas BIGINT) STORED BY \'org.elasticsearch.hadoop.hive.EsStorageHandler\' TBLPROPERTIES(\'es.resource\' = \'ob_src_bluecoat/descarga_dominio\', \'es.mapping.id\' = \'ID\', \'es.id.field\' = \'ID\', \'es.index.auto.create\' = \'true\',\'es.nodes\' = \'180.133.240.42,180.133.240.43,180.133.240.44\', \'es.port\' = \'9200\', \'es.mapping.names\' = \'eventtimestamp:@timestamp\')','java.sql.SQLException: Error while compiling statement: FAILED: SemanticException [Error 10025]: Line 3:0 Expression not in GROUP BY key \'requestDomainrequestDomain\'','ID','','ob_src_bluecoat','eventtimestamp','descarga_dominio','Ok','2014-07-29 15:03:20','2014-07-29 15:04:47','','','','','INSERT OVERWRITE TABLE descarga_dominio SELECT\nCONCAT(eventTimeStamp,\"-\",requestDomain) as ID,\nrequestDomain,\neventTimeStamp,\nCount(1) as descargas\n FROM ob_src_bluecoat WHERE requestURIExtension not in (\"html\", \"htm\", \"-\", \"php\") AND eventtimestamp>\"2014-07-25 10:00:00\" AND eventtimestamp<=\"2014-07-25 22:00:00\"\nGROUP BY eventTimeStamp,requestDomain','SELECT\nCONCAT(eventTimeStamp,\"-\",requestDomain) as ID,\nrequestDomain,\neventTimeStamp,\nCount(1) as descargas\n','4','ID STRING,\nrequestDomain STRING,\neventTimeStamp timestamp,\ndescargas BIGINT',NULL,NULL,6),(23,'FROM ob_src_bluecoat','WHERE requestURIExtension in (\"exe\", \"pl\", \"js\") OR\ncontentType in (\"application/x-msdos-program\",\"application/x-javascript\",\"application/javascript\")\nGROUP BY eventTimeStamp,requestPath,userCode,requestDomain\n','Descargas de archivos ejecutables por usuario','descarga_ejecutables_usuario','CREATE EXTERNAL TABLE descarga_ejecutables_usuario(ID STRING,\nusuario_descarga STRING,\nuserCode STRING,\ndominio STRING,\nrecurso STRING,\neventTimeStamp timestamp,\ndescargas BIGINT,\nbytes BIGINT) STORED BY \'org.elasticsearch.hadoop.hive.EsStorageHandler\' TBLPROPERTIES(\'es.resource\' = \'ob_src_bluecoat/descarga_ejecutables_usuario\', \'es.mapping.id\' = \'ID\', \'es.id.field\' = \'ID\', \'es.index.auto.create\' = \'true\',\'es.nodes\' = \'180.133.240.42,180.133.240.43,180.133.240.44\', \'es.port\' = \'9200\', \'es.mapping.names\' = \'eventtimestamp:@timestamp\')','java.sql.SQLException: Error while processing statement: FAILED: Execution Error, return code 2 from org.apache.hadoop.hive.ql.exec.mr.MapRedTask','ID','','ob_src_bluecoat','eventtimestamp','descarga_ejecutables_usuario','Ok','2014-07-30 12:46:21','2014-07-31 08:19:40','','','','','INSERT OVERWRITE TABLE descarga_ejecutables_usuario SELECT\nCONCAT(eventTimeStamp,\"-\",requestPath,\"-\",userCode) as ID,\nCONCAT(requestPath,\"-\",userCode) as usuario_descarga,\nuserCode,\nrequestDomain as dominio,\nrequestPath as recurso,\neventTimeStamp,\nCount(1) as descargas,\nSUM(scBytes) as bytes FROM ob_src_bluecoat WHERE requestURIExtension in (\"exe\", \"pl\", \"js\") OR\ncontentType in (\"application/x-msdos-program\",\"application/x-javascript\",\"application/javascript\")\nGROUP BY eventTimeStamp,requestPath,userCode,requestDomain\n','SELECT\nCONCAT(eventTimeStamp,\"-\",requestPath,\"-\",userCode) as ID,\nCONCAT(requestPath,\"-\",userCode) as usuario_descarga,\nuserCode,\nrequestDomain as dominio,\nrequestPath as recurso,\neventTimeStamp,\nCount(1) as descargas,\nSUM(scBytes) as bytes','4','ID STRING,\nusuario_descarga STRING,\nuserCode STRING,\ndominio STRING,\nrecurso STRING,\neventTimeStamp timestamp,\ndescargas BIGINT,\nbytes BIGINT','anonymousUser',NULL,6),(24,'FROM ob_src_bluecoat','WHERE requestURIExtension in (\"rar\", \"zip\", \"jar\", \"tar\", \"gz\", \"Z\", \"tgz\", \"gzip\", \"ace\") and eventtimestamp>\"2014-07-25 11:00:00\"\nGROUP BY eventTimeStamp,requestPath,userCode,requestDomain','Descarga de archivos comprimidos por usuario','descarga_comprimidos_usuario','CREATE EXTERNAL TABLE descarga_comprimidos_usuario(ID STRING,\nusuario_descarga STRING,\nuserCode STRING,\ndominio STRING,\nrecurso STRING,\neventTimeStamp timestamp,\ndescargas BIGINT,\nbytes BIGINT) STORED BY \'org.elasticsearch.hadoop.hive.EsStorageHandler\' TBLPROPERTIES(\'es.resource\' = \'ob_src_bluecoat/descarga_comprimidos_usuario\', \'es.mapping.id\' = \'ID\', \'es.id.field\' = \'ID\', \'es.index.auto.create\' = \'true\',\'es.nodes\' = \'180.133.240.42,180.133.240.43,180.133.240.44\', \'es.port\' = \'9200\', \'es.mapping.names\' = \'eventtimestamp:@timestamp\')','java.sql.SQLException: Error while processing statement: FAILED: Execution Error, return code 2 from org.apache.hadoop.hive.ql.exec.mr.MapRedTask','ID','','ob_src_bluecoat','eventtimestamp','descarga_comprimidos_usuario','Ok','2014-07-30 13:00:03','2014-07-30 13:19:10','','','','','INSERT OVERWRITE TABLE descarga_comprimidos_usuario SELECT\nCONCAT(eventTimeStamp,\"-\",requestPath,\"-\",userCode) as ID,\nCONCAT(requestPath,\"-\",userCode) as usuario_descarga,\nuserCode,\nrequestDomain as dominio,\nrequestPath as recurso,\neventTimeStamp,\nCount(1) as descargas,\nSUM(scBytes) as bytes FROM ob_src_bluecoat WHERE requestURIExtension in (\"rar\", \"zip\", \"jar\", \"tar\", \"gz\", \"Z\", \"tgz\", \"gzip\", \"ace\") and eventtimestamp>\"2014-07-25 11:00:00\"\nGROUP BY eventTimeStamp,requestPath,userCode,requestDomain','SELECT\nCONCAT(eventTimeStamp,\"-\",requestPath,\"-\",userCode) as ID,\nCONCAT(requestPath,\"-\",userCode) as usuario_descarga,\nuserCode,\nrequestDomain as dominio,\nrequestPath as recurso,\neventTimeStamp,\nCount(1) as descargas,\nSUM(scBytes) as bytes','4','ID STRING,\nusuario_descarga STRING,\nuserCode STRING,\ndominio STRING,\nrecurso STRING,\neventTimeStamp timestamp,\ndescargas BIGINT,\nbytes BIGINT','anonymousUser',NULL,8),(25,'FROM ob_src_bluecoat','WHERE requestURIExtension in (\"flv\", \"mpeg\", \"avi\", \"f4m\", \"bootstrap\", \"mp4\")  OR\ncontentType in (\"video/mp4\",\"video/f4f\",\"video/x-flv\",\"video/f4m\",\"video/abst\",\"video/webm\",\"video/x-ms-asf\") and eventtimestamp>\"2014-07-25 11:00:00\"\nGROUP BY eventTimeStamp,requestPath,userCode,requestDomain','Descargas de archivos de v√≠deo','descarga_video_usuario','CREATE EXTERNAL TABLE descarga_video_usuario(ID STRING,\nusuario_descarga STRING,\nuserCode STRING,\ndominio STRING,\nrecurso STRING,\neventTimeStamp timestamp,\ndescargas BIGINT,\nbytes BIGINT) STORED BY \'org.elasticsearch.hadoop.hive.EsStorageHandler\' TBLPROPERTIES(\'es.resource\' = \'ob_src_bluecoat/descarga_video_usuario\', \'es.mapping.id\' = \'ID\', \'es.id.field\' = \'ID\', \'es.index.auto.create\' = \'true\',\'es.nodes\' = \'180.133.240.42,180.133.240.43,180.133.240.44\', \'es.port\' = \'9200\', \'es.mapping.names\' = \'eventtimestamp:@timestamp\')','java.sql.SQLException: Error while compiling statement: FAILED: ParseException line 9:48 missing EOF at \'requestURIExtension\' near \'HERE\'','ID','','ob_src_bluecoat','eventtimestamp','descarga_video_usuario','Ok','2014-07-30 13:21:08','2014-07-30 17:46:21','','','','','INSERT OVERWRITE TABLE descarga_video_usuario SELECT\nCONCAT(eventTimeStamp,\"-\",requestPath,\"-\",userCode) as ID,\nCONCAT(requestPath,\"-\",userCode) as usuario_descarga,\nuserCode,\nrequestDomain as dominio,\nrequestPath as recurso,\neventTimeStamp,\nCount(1) as descargas,\nSUM(scBytes) as bytes FROM ob_src_bluecoat WHERE requestURIExtension in (\"flv\", \"mpeg\", \"avi\", \"f4m\", \"bootstrap\", \"mp4\")  OR\ncontentType in (\"video/mp4\",\"video/f4f\",\"video/x-flv\",\"video/f4m\",\"video/abst\",\"video/webm\",\"video/x-ms-asf\") and eventtimestamp>\"2014-07-25 11:00:00\"\nGROUP BY eventTimeStamp,requestPath,userCode,requestDomain','SELECT\nCONCAT(eventTimeStamp,\"-\",requestPath,\"-\",userCode) as ID,\nCONCAT(requestPath,\"-\",userCode) as usuario_descarga,\nuserCode,\nrequestDomain as dominio,\nrequestPath as recurso,\neventTimeStamp,\nCount(1) as descargas,\nSUM(scBytes) as bytes','4','ID STRING,\nusuario_descarga STRING,\nuserCode STRING,\ndominio STRING,\nrecurso STRING,\neventTimeStamp timestamp,\ndescargas BIGINT,\nbytes BIGINT','admin',NULL,5),(26,'FROM ob_src_ironport','WHERE ICID is not NULL AND mid is not NULL AND RID is NULL and mailfrom =\"null\"\nGROUP BY ICID,MID) REL\nLEFT JOIN\n(\nSELECT \nICID\n,eventTimeStamp,INTERFACEIP\nfrom ob_src_ironport \nWHERE ICID is not NULL and INTERFACEIP <>\"null\"\n)ENTR\nON ENTR.ICID=REL.ICID\nGROUP BY eventTimeStamp,MID,REL.ICID,INTERFACEIP','Total de mensajes de ironport','total_mensajes','CREATE EXTERNAL TABLE total_mensajes(ID STRING,\neventTimeStamp timestamp,\nICID BIGINT,\nMID BIGINT,\nINTERFACEIP STRING) STORED BY \'org.elasticsearch.hadoop.hive.EsStorageHandler\' TBLPROPERTIES(\'es.resource\' = \'ob_src_ironport/total_mensajes\', \'es.mapping.id\' = \'ID\', \'es.id.field\' = \'ID\', \'es.index.auto.create\' = \'true\',\'es.nodes\' = \'180.133.240.42,180.133.240.43,180.133.240.44\', \'es.port\' = \'9200\', \'es.mapping.names\' = \'eventtimestamp:@timestamp\')',NULL,'ID','','ob_src_ironport','eventtimestamp','total_mensajes','Ok','2014-07-30 14:45:51','2014-07-30 14:48:01','','',NULL,'','INSERT OVERWRITE TABLE total_mensajes SELECT\nCONCAT(REL.ICID,\"-\",MID) as ID,\neventTimeStamp,\nREL.ICID,\nMID,\nINTERFACEIP\nFROM(\nselect ICID,MID  FROM ob_src_ironport WHERE ICID is not NULL AND mid is not NULL AND RID is NULL and mailfrom =\"null\"\nGROUP BY ICID,MID) REL\nLEFT JOIN\n(\nSELECT \nICID\n,eventTimeStamp,INTERFACEIP\nfrom ob_src_ironport \nWHERE ICID is not NULL and INTERFACEIP <>\"null\"\n)ENTR\nON ENTR.ICID=REL.ICID\nGROUP BY eventTimeStamp,MID,REL.ICID,INTERFACEIP','SELECT\nCONCAT(REL.ICID,\"-\",MID) as ID,\neventTimeStamp,\nREL.ICID,\nMID,\nINTERFACEIP\nFROM(\nselect ICID,MID ','2','ID STRING,\neventTimeStamp timestamp,\nICID BIGINT,\nMID BIGINT,\nINTERFACEIP STRING',NULL,NULL,2),(27,'FROM ob_src_ironport','WHERE REPUTATION like \"%TCPREFUSE%\" OR REPUTATION like \"%REJECTED%\") DATOS\nJOIN\n(\nSELECT \nICID,\nINTERFACEIP\nfrom ob_src_ironport \nWHERE ICID is not NULL and INTERFACEIP <>\"null\"\n) INTERF\nON INTERF.ICID=DATOS.ICID','Correos rechazados por Filtro de Reputaci√≥n','filtro_reputacion','CREATE EXTERNAL TABLE filtro_reputacion(ID STRING,\neventTimeStamp timestamp,\nICID BIGINT,\nREPUTATION STRING,\nINTERFACEIP STRING) STORED BY \'org.elasticsearch.hadoop.hive.EsStorageHandler\' TBLPROPERTIES(\'es.resource\' = \'ob_src_ironport/filtro_reputacion\', \'es.mapping.id\' = \'ID\', \'es.id.field\' = \'ID\', \'es.index.auto.create\' = \'true\',\'es.nodes\' = \'180.133.240.42,180.133.240.43,180.133.240.44\', \'es.port\' = \'9200\', \'es.mapping.names\' = \'eventtimestamp:@timestamp\')',NULL,'ID','','ob_src_ironport','eventtimestamp','filtro_reputacion','Ok','2014-07-30 14:54:27','2014-07-30 14:57:19','','',NULL,'','INSERT OVERWRITE TABLE filtro_reputacion SELECT\nDATOS.ICID as ID,\neventTimeStamp,\nDATOS.ICID,\nREPUTATION,\nINTERFACEIP\nFROM \n(\nSELECT \nREPUTATION,\neventTimeStamp,\nICID FROM ob_src_ironport WHERE REPUTATION like \"%TCPREFUSE%\" OR REPUTATION like \"%REJECTED%\") DATOS\nJOIN\n(\nSELECT \nICID,\nINTERFACEIP\nfrom ob_src_ironport \nWHERE ICID is not NULL and INTERFACEIP <>\"null\"\n) INTERF\nON INTERF.ICID=DATOS.ICID','SELECT\nDATOS.ICID as ID,\neventTimeStamp,\nDATOS.ICID,\nREPUTATION,\nINTERFACEIP\nFROM \n(\nSELECT \nREPUTATION,\neventTimeStamp,\nICID','2','ID STRING,\neventTimeStamp timestamp,\nICID BIGINT,\nREPUTATION STRING,\nINTERFACEIP STRING',NULL,NULL,2),(28,'FROM ob_src_ironport','where BOUNCEDESC like \"%nvalid recipient%\" AND DSNBOUNCE =\"5.1.0\") BOUNCE\n LEFT JOIN\n(\nselect ICID,MID \nfrom ob_src_ironport \nWHERE ICID is not NULL AND mid is not NULL AND RID is NULL\nGROUP BY ICID,MID) REL\nON REL.MID=BOUNCE.MID\nLEFT JOIN\n(\nSELECT \nICID,\nINTERFACEIP\nfrom ob_src_ironport \nWHERE ICID is not NULL and INTERFACEIP <>\"null\"\n) INTERF\nON INTERF.ICID=REL.ICID','Correos descartados por Receptor no v√°lido','receptor_no_valido','CREATE EXTERNAL TABLE receptor_no_valido(ID STRING,\neventTimeStamp timestamp,\nICID BIGINT,\nMID BIGINT,\nDSNBOUNCE STRING,\nBOUNCEDESC STRING,\nINTERFACEIP STRING) STORED BY \'org.elasticsearch.hadoop.hive.EsStorageHandler\' TBLPROPERTIES(\'es.resource\' = \'ob_src_ironport/receptor_no_valido\', \'es.mapping.id\' = \'ID\', \'es.id.field\' = \'ID\', \'es.index.auto.create\' = \'true\',\'es.nodes\' = \'180.133.240.42,180.133.240.43,180.133.240.44\', \'es.port\' = \'9200\', \'es.mapping.names\' = \'eventtimestamp:@timestamp\')',NULL,'ID','','ob_src_ironport','eventtimestamp','receptor_no_valido','Ok','2014-07-30 15:01:07','2014-07-30 15:02:43','','',NULL,'','INSERT OVERWRITE TABLE receptor_no_valido SELECT\nCONCAT(REL.ICID,\"-\",REL.MID) as ID,\neventTimeStamp,\nREL.ICID,\nREL.MID,\nDSNBOUNCE,\nBOUNCEDESC,\nINTERFACEIP\nFROM\n(\nSELECT\neventTimeStamp,\nMID,\nDSNBOUNCE,\nBOUNCEDESC  FROM ob_src_ironport where BOUNCEDESC like \"%nvalid recipient%\" AND DSNBOUNCE =\"5.1.0\") BOUNCE\n LEFT JOIN\n(\nselect ICID,MID \nfrom ob_src_ironport \nWHERE ICID is not NULL AND mid is not NULL AND RID is NULL\nGROUP BY ICID,MID) REL\nON REL.MID=BOUNCE.MID\nLEFT JOIN\n(\nSELECT \nICID,\nINTERFACEIP\nfrom ob_src_ironport \nWHERE ICID is not NULL and INTERFACEIP <>\"null\"\n) INTERF\nON INTERF.ICID=REL.ICID','SELECT\nCONCAT(REL.ICID,\"-\",REL.MID) as ID,\neventTimeStamp,\nREL.ICID,\nREL.MID,\nDSNBOUNCE,\nBOUNCEDESC,\nINTERFACEIP\nFROM\n(\nSELECT\neventTimeStamp,\nMID,\nDSNBOUNCE,\nBOUNCEDESC ','2','ID STRING,\neventTimeStamp timestamp,\nICID BIGINT,\nMID BIGINT,\nDSNBOUNCE STRING,\nBOUNCEDESC STRING,\nINTERFACEIP STRING',NULL,NULL,2),(29,'FROM ob_src_ironport','where SPAMCASE <> \"null\") SPAM\nJOIN\n(\nselect ICID,MID \nfrom ob_src_ironport \nWHERE ICID is not NULL AND mid is not NULL AND RID is NULL\nGROUP BY ICID,MID) REL\nON REL.MID=SPAM.MID\nJOIN\n(\nSELECT \nICID,\nINTERFACEIP\nfrom ob_src_ironport \nWHERE ICID is not NULL and INTERFACEIP <>\"null\"\n) INTERF\nON INTERF.ICID=REL.ICID','Correos detectados como Spam','spam','CREATE EXTERNAL TABLE spam(ID STRING,\neventTimeStamp timestamp,\nICID BIGINT,\nMID BIGINT,\nSPAMCASE STRING,\nINTERFACEIP STRING) STORED BY \'org.elasticsearch.hadoop.hive.EsStorageHandler\' TBLPROPERTIES(\'es.resource\' = \'ob_src_ironport/spam\', \'es.mapping.id\' = \'ID\', \'es.id.field\' = \'ID\', \'es.index.auto.create\' = \'true\',\'es.nodes\' = \'180.133.240.42,180.133.240.43,180.133.240.44\', \'es.port\' = \'9200\', \'es.mapping.names\' = \'eventtimestamp:@timestamp\')',NULL,'ID','','ob_src_ironport','eventtimestamp','spam','Ok','2014-07-30 15:07:56','2014-07-30 15:09:32','','',NULL,'','INSERT OVERWRITE TABLE spam SELECT\nCONCAT(REL.ICID,\"-\",REL.MID) as ID,\neventTimeStamp,\nREL.ICID,\nREL.MID,\nSPAMCASE,\nINTERFACEIP\nFROM\n(\nSELECT\neventTimeStamp,\nMID,\"POSITIVE\" as SPAMCASE FROM ob_src_ironport where SPAMCASE <> \"null\") SPAM\nJOIN\n(\nselect ICID,MID \nfrom ob_src_ironport \nWHERE ICID is not NULL AND mid is not NULL AND RID is NULL\nGROUP BY ICID,MID) REL\nON REL.MID=SPAM.MID\nJOIN\n(\nSELECT \nICID,\nINTERFACEIP\nfrom ob_src_ironport \nWHERE ICID is not NULL and INTERFACEIP <>\"null\"\n) INTERF\nON INTERF.ICID=REL.ICID','SELECT\nCONCAT(REL.ICID,\"-\",REL.MID) as ID,\neventTimeStamp,\nREL.ICID,\nREL.MID,\nSPAMCASE,\nINTERFACEIP\nFROM\n(\nSELECT\neventTimeStamp,\nMID,\"POSITIVE\" as SPAMCASE','2','ID STRING,\neventTimeStamp timestamp,\nICID BIGINT,\nMID BIGINT,\nSPAMCASE STRING,\nINTERFACEIP STRING',NULL,NULL,2),(30,'FROM ob_src_ironport','where ANTIVIRUS<>\"null\" ) VIRUS\n JOIN\n(\nselect ICID,MID \nfrom ob_src_ironport \nWHERE ICID is not NULL AND mid is not NULL AND RID is NULL\nGROUP BY ICID,MID) REL\nON REL.MID=VIRUS.MID\nJOIN\n(\nSELECT \nICID,\nINTERFACEIP\nfrom ob_src_ironport \nWHERE ICID is not NULL and INTERFACEIP <>\"null\"\n) INTERF\nON INTERF.ICID=REL.ICID','Correos detectados con virus','virus','CREATE EXTERNAL TABLE virus(ID STRING,\neventTimeStamp timestamp,\nICID BIGINT,\nMID BIGINT,\nANTIVIRUS STRING,\nINTERFACEIP STRING) STORED BY \'org.elasticsearch.hadoop.hive.EsStorageHandler\' TBLPROPERTIES(\'es.resource\' = \'ob_src_ironport/virus\', \'es.mapping.id\' = \'ID\', \'es.id.field\' = \'ID\', \'es.index.auto.create\' = \'true\',\'es.nodes\' = \'180.133.240.42,180.133.240.43,180.133.240.44\', \'es.port\' = \'9200\', \'es.mapping.names\' = \'eventtimestamp:@timestamp\')',NULL,'ID','','ob_src_ironport','eventtimestamp','virus','Ok','2014-07-30 15:11:36','2014-07-30 15:13:20','','',NULL,'','INSERT OVERWRITE TABLE virus SELECT\nCONCAT(REL.ICID,\"-\",REL.MID) as ID,\neventTimeStamp,\nREL.ICID,\nREL.MID,\nANTIVIRUS,\nINTERFACEIP\nFROM\n(\nSELECT\neventTimeStamp,\nMID,\nANTIVIRUS FROM ob_src_ironport where ANTIVIRUS<>\"null\" ) VIRUS\n JOIN\n(\nselect ICID,MID \nfrom ob_src_ironport \nWHERE ICID is not NULL AND mid is not NULL AND RID is NULL\nGROUP BY ICID,MID) REL\nON REL.MID=VIRUS.MID\nJOIN\n(\nSELECT \nICID,\nINTERFACEIP\nfrom ob_src_ironport \nWHERE ICID is not NULL and INTERFACEIP <>\"null\"\n) INTERF\nON INTERF.ICID=REL.ICID','SELECT\nCONCAT(REL.ICID,\"-\",REL.MID) as ID,\neventTimeStamp,\nREL.ICID,\nREL.MID,\nANTIVIRUS,\nINTERFACEIP\nFROM\n(\nSELECT\neventTimeStamp,\nMID,\nANTIVIRUS','2','ID STRING,\neventTimeStamp timestamp,\nICID BIGINT,\nMID BIGINT,\nANTIVIRUS STRING,\nINTERFACEIP STRING',NULL,NULL,2),(31,'FROM ob_src_ironport','where FILTROCONTENIDO<>\"null\" ) FILTR\n JOIN\n(\nselect ICID,MID \nfrom ob_src_ironport \nWHERE ICID is not NULL AND mid is not NULL AND RID is NULL\nGROUP BY ICID,MID) REL\nON REL.MID=FILTR.MID\nJOIN\n(\nSELECT \nICID,\nINTERFACEIP\nfrom ob_src_ironport \nWHERE ICID is not NULL and INTERFACEIP <>\"null\"\n) INTERF\nON INTERF.ICID=REL.ICID','Correos bloqueados por filtro de contenido','content_filter','CREATE EXTERNAL TABLE content_filter(ID STRING,\neventTimeStamp timestamp,\nICID BIGINT,\nMID BIGINT,\nFILTROCONTENIDO STRING,\nINTERFACEIP STRING) STORED BY \'org.elasticsearch.hadoop.hive.EsStorageHandler\' TBLPROPERTIES(\'es.resource\' = \'ob_src_ironport/content_filter\', \'es.mapping.id\' = \'ID\', \'es.id.field\' = \'ID\', \'es.index.auto.create\' = \'true\',\'es.nodes\' = \'180.133.240.42,180.133.240.43,180.133.240.44\', \'es.port\' = \'9200\', \'es.mapping.names\' = \'eventtimestamp:@timestamp\')',NULL,'ID','','ob_src_ironport','eventtimestamp','content_filter','Ok','2014-07-30 15:14:48','2014-07-30 15:16:20','','',NULL,'','INSERT OVERWRITE TABLE content_filter SELECT\nCONCAT(REL.ICID,\"-\",REL.MID) as ID,\neventTimeStamp,\nREL.ICID,\nREL.MID,\nFILTROCONTENIDO,\nINTERFACEIP\nFROM\n(\nSELECT\neventTimeStamp,\nMID,\nFILTROCONTENIDO FROM ob_src_ironport where FILTROCONTENIDO<>\"null\" ) FILTR\n JOIN\n(\nselect ICID,MID \nfrom ob_src_ironport \nWHERE ICID is not NULL AND mid is not NULL AND RID is NULL\nGROUP BY ICID,MID) REL\nON REL.MID=FILTR.MID\nJOIN\n(\nSELECT \nICID,\nINTERFACEIP\nfrom ob_src_ironport \nWHERE ICID is not NULL and INTERFACEIP <>\"null\"\n) INTERF\nON INTERF.ICID=REL.ICID','SELECT\nCONCAT(REL.ICID,\"-\",REL.MID) as ID,\neventTimeStamp,\nREL.ICID,\nREL.MID,\nFILTROCONTENIDO,\nINTERFACEIP\nFROM\n(\nSELECT\neventTimeStamp,\nMID,\nFILTROCONTENIDO','2','ID STRING,\neventTimeStamp timestamp,\nICID BIGINT,\nMID BIGINT,\nFILTROCONTENIDO STRING,\nINTERFACEIP STRING',NULL,NULL,2),(32,'FROM ob_src_ironport','where MARKETINGCASE <>\"null\" ) MARKET\n JOIN\n(\nselect ICID,MID \nfrom ob_src_ironport \nWHERE ICID is not NULL AND mid is not NULL AND RID is NULL\nGROUP BY ICID,MID) REL\nON REL.MID=MARKET.MID\nJOIN\n(\nSELECT \nICID,\nINTERFACEIP\nfrom ob_src_ironport \nWHERE ICID is not NULL and INTERFACEIP <>\"null\"\n) INTERF\nON INTERF.ICID=REL.ICID','Correos de marketing','marketing','CREATE EXTERNAL TABLE marketing(ID STRING,\neventTimeStamp timestamp,\nICID BIGINT,\nMID BIGINT,\nMARKETINGCASE STRING,\nINTERFACEIP STRING) STORED BY \'org.elasticsearch.hadoop.hive.EsStorageHandler\' TBLPROPERTIES(\'es.resource\' = \'ob_src_ironport/marketing\', \'es.mapping.id\' = \'ID\', \'es.id.field\' = \'ID\', \'es.index.auto.create\' = \'true\',\'es.nodes\' = \'180.133.240.42,180.133.240.43,180.133.240.44\', \'es.port\' = \'9200\', \'es.mapping.names\' = \'eventtimestamp:@timestamp\')',NULL,'ID','','ob_src_ironport','eventtimestamp','marketing','Ok','2014-07-30 15:21:20','2014-07-30 15:22:52','','',NULL,'','INSERT OVERWRITE TABLE marketing SELECT\nCONCAT(REL.ICID,\"-\",REL.MID) as ID,\neventTimeStamp,\nREL.ICID,\nREL.MID,\nMARKETINGCASE,\nINTERFACEIP\nFROM\n(\nSELECT\neventTimeStamp,\nMID,\nMARKETINGCASE FROM ob_src_ironport where MARKETINGCASE <>\"null\" ) MARKET\n JOIN\n(\nselect ICID,MID \nfrom ob_src_ironport \nWHERE ICID is not NULL AND mid is not NULL AND RID is NULL\nGROUP BY ICID,MID) REL\nON REL.MID=MARKET.MID\nJOIN\n(\nSELECT \nICID,\nINTERFACEIP\nfrom ob_src_ironport \nWHERE ICID is not NULL and INTERFACEIP <>\"null\"\n) INTERF\nON INTERF.ICID=REL.ICID','SELECT\nCONCAT(REL.ICID,\"-\",REL.MID) as ID,\neventTimeStamp,\nREL.ICID,\nREL.MID,\nMARKETINGCASE,\nINTERFACEIP\nFROM\n(\nSELECT\neventTimeStamp,\nMID,\nMARKETINGCASE','2','ID STRING,\neventTimeStamp timestamp,\nICID BIGINT,\nMID BIGINT,\nMARKETINGCASE STRING,\nINTERFACEIP STRING',NULL,NULL,2),(33,'FROM ob_src_ironport','where RESPONSE <>\"null\" ) OK\n JOIN\n(\nselect ICID,MID \nfrom ob_src_ironport \nWHERE ICID is not NULL AND mid is not NULL AND RID is NULL\nGROUP BY ICID,MID) REL\nON REL.MID=OK.MID\nJOIN\n(\nSELECT \nICID,\nINTERFACEIP\nfrom ob_src_ironport \nWHERE ICID is not NULL and INTERFACEIP <>\"null\"\n) INTERF\nON INTERF.ICID=REL.ICID','Correos limpios','correos_limpios','CREATE EXTERNAL TABLE correos_limpios(ID STRING,\neventTimeStamp timestamp,\nICID BIGINT,\nMID BIGINT,\nRID BIGINT,\nRESPONSE STRING,\nINTERFACEIP STRING) STORED BY \'org.elasticsearch.hadoop.hive.EsStorageHandler\' TBLPROPERTIES(\'es.resource\' = \'ob_src_ironport/correos_limpios\', \'es.mapping.id\' = \'ID\', \'es.id.field\' = \'ID\', \'es.index.auto.create\' = \'true\',\'es.nodes\' = \'180.133.240.42,180.133.240.43,180.133.240.44\', \'es.port\' = \'9200\', \'es.mapping.names\' = \'eventtimestamp:@timestamp\')',NULL,'ID','','ob_src_ironport','eventtimestamp','correos_limpios','Ok','2014-07-30 15:25:32','2014-07-30 16:10:51','','','','','INSERT OVERWRITE TABLE correos_limpios SELECT\nCONCAT(REL.ICID,\"-\",REL.MID) as ID,\neventTimeStamp,\nREL.ICID,\nREL.MID,\nRID,\nRESPONSE,\nINTERFACEIP\nFROM\n(\nSELECT\neventTimeStamp,\nMID,RID,\nRESPONSE FROM ob_src_ironport where RESPONSE <>\"null\" ) OK\n JOIN\n(\nselect ICID,MID \nfrom ob_src_ironport \nWHERE ICID is not NULL AND mid is not NULL AND RID is NULL\nGROUP BY ICID,MID) REL\nON REL.MID=OK.MID\nJOIN\n(\nSELECT \nICID,\nINTERFACEIP\nfrom ob_src_ironport \nWHERE ICID is not NULL and INTERFACEIP <>\"null\"\n) INTERF\nON INTERF.ICID=REL.ICID','SELECT\nCONCAT(REL.ICID,\"-\",REL.MID) as ID,\neventTimeStamp,\nREL.ICID,\nREL.MID,\nRID,\nRESPONSE,\nINTERFACEIP\nFROM\n(\nSELECT\neventTimeStamp,\nMID,RID,\nRESPONSE','2','ID STRING,\neventTimeStamp timestamp,\nICID BIGINT,\nMID BIGINT,\nRID BIGINT,\nRESPONSE STRING,\nINTERFACEIP STRING',NULL,NULL,4),(34,'FROM ob_src_ironport','WHERE ICID is not NULL and MID is not NULL and RID is not NULL and mailto <> \"null\"\nGROUP BY MONTH(eventTimeStamp),YEAR(eventTimeStamp)','Primer y √∫ltimo correo por a√±o y mes','primult_awstats','CREATE EXTERNAL TABLE primult_awstats(ID STRING,\nANO BIGINT,\nMES BIGINT,\nPRIMERO TIMESTAMP,\nULTIMO TIMESTAMP) STORED BY \'org.elasticsearch.hadoop.hive.EsStorageHandler\' TBLPROPERTIES(\'es.resource\' = \'ob_src_ironport/primult_awstats\', \'es.mapping.id\' = \'ID\', \'es.id.field\' = \'ID\', \'es.index.auto.create\' = \'true\',\'es.nodes\' = \'180.133.240.42,180.133.240.43,180.133.240.44\', \'es.port\' = \'9200\', \'es.mapping.names\' = \'eventtimestamp:@timestamp\')',NULL,'ID','','ob_src_ironport','eventtimestamp','primult_awstats','Ok','2014-07-30 15:31:42','2014-07-30 15:32:16','','',NULL,'','INSERT OVERWRITE TABLE primult_awstats SELECT\nCONCAT(YEAR(eventTimeStamp),\"-\",MONTH(eventTimeStamp)) as ID,\nYEAR(eventTimeStamp) as ANO,\nMONTH(eventTimeStamp) as MES,\nMIN(eventTimeStamp) as PRIMERO,\nMAX(eventTimeStamp) as ULTIMO FROM ob_src_ironport WHERE ICID is not NULL and MID is not NULL and RID is not NULL and mailto <> \"null\"\nGROUP BY MONTH(eventTimeStamp),YEAR(eventTimeStamp)','SELECT\nCONCAT(YEAR(eventTimeStamp),\"-\",MONTH(eventTimeStamp)) as ID,\nYEAR(eventTimeStamp) as ANO,\nMONTH(eventTimeStamp) as MES,\nMIN(eventTimeStamp) as PRIMERO,\nMAX(eventTimeStamp) as ULTIMO','2','ID STRING,\nANO BIGINT,\nMES BIGINT,\nPRIMERO TIMESTAMP,\nULTIMO TIMESTAMP',NULL,NULL,2),(35,'FROM ob_src_ironport','WHERE RESPONSE <> \"null\"\nGROUP BY MONTH(eventTimeStamp),YEAR(eventTimeStamp),MID) CANT\nJOIN\n(\nSELECT \nMID,\nSUM(BYTES) as bytes\nFROM ob_src_ironport\nWHERE bytes is not NULL\nGROUP BY MID\n)TAM\nON TAM.MID=CANT.MID\nGROUP BY MES,ANO','Correos ok por mes','correos_ok_awstats','CREATE EXTERNAL TABLE correos_ok_awstats(ID STRING,\nANO BIGINT,\nMES BIGINT,\nTOTAL BIGINT,\nBYTES BIGINT) STORED BY \'org.elasticsearch.hadoop.hive.EsStorageHandler\' TBLPROPERTIES(\'es.resource\' = \'ob_src_ironport/correos_ok_awstats\', \'es.mapping.id\' = \'ID\', \'es.id.field\' = \'ID\', \'es.index.auto.create\' = \'true\',\'es.nodes\' = \'180.133.240.42,180.133.240.43,180.133.240.44\', \'es.port\' = \'9200\', \'es.mapping.names\' = \'eventtimestamp:@timestamp\')',NULL,'ID','','ob_src_ironport','eventtimestamp','correos_ok_awstats','Ok','2014-07-30 15:33:29','2014-07-30 15:35:16','','',NULL,'','INSERT OVERWRITE TABLE correos_ok_awstats SELECT\nCONCAT(ano,\"-\",mes) as ID,\nANO,MES,\nsum(TOTAL) as TOTAL,\nSUM(bytes) as BYTES\nFROM\n(SELECT\nMONTH(eventTimeStamp) as MES,\nYEAR(eventTimeStamp) as ANO,\nMID,\nCOUNT(1) as TOTAL FROM ob_src_ironport WHERE RESPONSE <> \"null\"\nGROUP BY MONTH(eventTimeStamp),YEAR(eventTimeStamp),MID) CANT\nJOIN\n(\nSELECT \nMID,\nSUM(BYTES) as bytes\nFROM ob_src_ironport\nWHERE bytes is not NULL\nGROUP BY MID\n)TAM\nON TAM.MID=CANT.MID\nGROUP BY MES,ANO','SELECT\nCONCAT(ano,\"-\",mes) as ID,\nANO,MES,\nsum(TOTAL) as TOTAL,\nSUM(bytes) as BYTES\nFROM\n(SELECT\nMONTH(eventTimeStamp) as MES,\nYEAR(eventTimeStamp) as ANO,\nMID,\nCOUNT(1) as TOTAL','2','ID STRING,\nANO BIGINT,\nMES BIGINT,\nTOTAL BIGINT,\nBYTES BIGINT',NULL,NULL,2),(36,'FROM ob_src_ironport','WHERE DSNBOUNCE <> \"null\" or DSNDELAY  <> \"null\"\nGROUP BY MONTH(eventTimeStamp),YEAR(eventTimeStamp),MID) CANT\nJOIN\n(\nSELECT \nMID,\nSUM(BYTES) as bytes\nFROM ob_src_ironport\nWHERE bytes is not NULL\nGROUP BY MID\n)TAM\nON TAM.MID=CANT.MID\nGROUP BY MES,ANO','Correos err√≥neos o rechazados','correos_notok_awstats','CREATE EXTERNAL TABLE correos_notok_awstats(ID STRING,\nANO BIGINT,\nMES BIGINT,\nTOTAL BIGINT,\nBYTES BIGINT) STORED BY \'org.elasticsearch.hadoop.hive.EsStorageHandler\' TBLPROPERTIES(\'es.resource\' = \'ob_src_ironport/correos_notok_awstats\', \'es.mapping.id\' = \'ID\', \'es.id.field\' = \'ID\', \'es.index.auto.create\' = \'true\',\'es.nodes\' = \'180.133.240.42,180.133.240.43,180.133.240.44\', \'es.port\' = \'9200\', \'es.mapping.names\' = \'eventtimestamp:@timestamp\')',NULL,'ID','','ob_src_ironport','eventtimestamp','correos_notok_awstats','Ok','2014-07-30 15:37:31','2014-07-30 15:39:15','','',NULL,'','INSERT OVERWRITE TABLE correos_notok_awstats SELECT\nCONCAT(ANO,\"-\",MES) as ID,\nANO,\nMES,\nsum(TOTAL) as TOTAL,\nSUM(bytes) as BYTES\nFROM\n(SELECT\nMONTH(eventTimeStamp) as MES,\nYEAR(eventTimeStamp) as ANO,\nMID,\nCOUNT(1) as TOTAL FROM ob_src_ironport WHERE DSNBOUNCE <> \"null\" or DSNDELAY  <> \"null\"\nGROUP BY MONTH(eventTimeStamp),YEAR(eventTimeStamp),MID) CANT\nJOIN\n(\nSELECT \nMID,\nSUM(BYTES) as bytes\nFROM ob_src_ironport\nWHERE bytes is not NULL\nGROUP BY MID\n)TAM\nON TAM.MID=CANT.MID\nGROUP BY MES,ANO','SELECT\nCONCAT(ANO,\"-\",MES) as ID,\nANO,\nMES,\nsum(TOTAL) as TOTAL,\nSUM(bytes) as BYTES\nFROM\n(SELECT\nMONTH(eventTimeStamp) as MES,\nYEAR(eventTimeStamp) as ANO,\nMID,\nCOUNT(1) as TOTAL','2','ID STRING,\nANO BIGINT,\nMES BIGINT,\nTOTAL BIGINT,\nBYTES BIGINT',NULL,NULL,2),(37,'FROM ob_src_ironport','WHERE RESPONSE <> \"null\"\nGROUP BY eventTimestamp,MID) CANT\nJOIN\n(\nSELECT \nMID,\nSUM(BYTES) as bytes\nFROM ob_src_ironport\nWHERE bytes is not NULL\nGROUP BY MID\n)TAM\nON TAM.MID=CANT.MID\nGROUP BY eventTimestamp,MONTH(eventTimeStamp),\nYEAR(eventTimeStamp),\nDAY(eventTimestamp),\nHOUR(eventTimestamp),\nfrom_unixtime(unix_timestamp(eventTimestamp), \'EEEE\')',' Correos OK por unidad de tiempo','correos_ok_tiempo_awstats','CREATE EXTERNAL TABLE correos_ok_tiempo_awstats(ID STRING,\neventTimeStamp TIMESTAMP,\nANO BIGINT,\nMES BIGINT,\nDIA BIGINT,\nHORA BIGINT,\nDIASEMANA STRING,\nTOTAL BIGINT,\nBYTES BIGINT) STORED BY \'org.elasticsearch.hadoop.hive.EsStorageHandler\' TBLPROPERTIES(\'es.resource\' = \'ob_src_ironport/correos_ok_tiempo_awstats\', \'es.mapping.id\' = \'ID\', \'es.id.field\' = \'ID\', \'es.index.auto.create\' = \'true\',\'es.nodes\' = \'180.133.240.42,180.133.240.43,180.133.240.44\', \'es.port\' = \'9200\', \'es.mapping.names\' = \'eventtimestamp:@timestamp\')',NULL,'ID','','ob_src_ironport','eventtimestamp','correos_ok_tiempo_awstats','Ok','2014-07-30 15:43:26','2014-07-30 16:14:03','','','','','INSERT OVERWRITE TABLE correos_ok_tiempo_awstats SELECT\neventTimestamp as ID,\neventTimestamp ,\nYEAR(eventTimeStamp) as ANO,\nMONTH(eventTimeStamp) as MES,\nDAY(eventTimestamp) as DIA,\nHOUR(eventTimestamp) as HORA,\nfrom_unixtime(unix_timestamp(eventTimestamp), \'EEEE\') as DIASEMANA,\nsum(TOTAL) as TOTAL,\nSUM(bytes) as BYTES\nFROM\n(SELECT\neventTimestamp ,\nMID,\nCOUNT(1) as TOTAL FROM ob_src_ironport WHERE RESPONSE <> \"null\"\nGROUP BY eventTimestamp,MID) CANT\nJOIN\n(\nSELECT \nMID,\nSUM(BYTES) as bytes\nFROM ob_src_ironport\nWHERE bytes is not NULL\nGROUP BY MID\n)TAM\nON TAM.MID=CANT.MID\nGROUP BY eventTimestamp,MONTH(eventTimeStamp),\nYEAR(eventTimeStamp),\nDAY(eventTimestamp),\nHOUR(eventTimestamp),\nfrom_unixtime(unix_timestamp(eventTimestamp), \'EEEE\')','SELECT\neventTimestamp as ID,\neventTimestamp ,\nYEAR(eventTimeStamp) as ANO,\nMONTH(eventTimeStamp) as MES,\nDAY(eventTimestamp) as DIA,\nHOUR(eventTimestamp) as HORA,\nfrom_unixtime(unix_timestamp(eventTimestamp), \'EEEE\') as DIASEMANA,\nsum(TOTAL) as TOTAL,\nSUM(bytes) as BYTES\nFROM\n(SELECT\neventTimestamp ,\nMID,\nCOUNT(1) as TOTAL','2','ID STRING,\neventTimeStamp TIMESTAMP,\nANO BIGINT,\nMES BIGINT,\nDIA BIGINT,\nHORA BIGINT,\nDIASEMANA STRING,\nTOTAL BIGINT,\nBYTES BIGINT',NULL,NULL,4),(38,'FROM ob_src_ironport','WHERE ICID is not NULL and HOSTIP <> \"null\") SERV\nJOIN\n(\nSELECT\nMID,ICID\nFROM ob_src_ironport\nWHERE MID is not NULL and ICID is not NULL\nGROUP BY MID,ICID\n)REL\nON REL.ICID=SERV.ICID\nJOIN\n(\nSELECT\nMID,\nSUM(BYTES) as bytes\nFROM ob_src_ironport\nWHERE bytes is not NULL\nGROUP BY MID\n)TAM\nON TAM.MID=REL.MID\nGROUP BY eventTimeStamp,HOSTIP,HOSTNAME','Correos enviados por servidor','correos_por_servidor_awstats','CREATE EXTERNAL TABLE correos_por_servidor_awstats(ID STRING,\neventTimeStamp TIMESTAMP,\nHOSTNAMEIP STRING,\nHOSTIP STRING,\nHOSTNAME STRING,\nTOTAL BIGINT,\nBYTES BIGINT) STORED BY \'org.elasticsearch.hadoop.hive.EsStorageHandler\' TBLPROPERTIES(\'es.resource\' = \'ob_src_ironport/correos_por_servidor_awstats\', \'es.mapping.id\' = \'ID\', \'es.id.field\' = \'ID\', \'es.index.auto.create\' = \'true\',\'es.nodes\' = \'180.133.240.42,180.133.240.43,180.133.240.44\', \'es.port\' = \'9200\', \'es.mapping.names\' = \'eventtimestamp:@timestamp\')',NULL,'ID','','ob_src_ironport','eventtimestamp','correos_por_servidor_awstats','Ok','2014-07-30 15:48:56','2014-07-30 15:51:40','','',NULL,'','INSERT OVERWRITE TABLE correos_por_servidor_awstats SELECT\nCONCAT(eventTimeStamp,\"-\",HOSTIP,\"-\",HOSTNAME) as ID,\neventTimeStamp,\nCONCAT(HOSTNAME,\"-[\",HOSTIP,\"]\") as HOSTNAMEIP,\nHOSTIP,\nHOSTNAME,\nCOUNT(1) as TOTAL,\nSUM(BYTES) as BYTES\nFROM\n(\nSELECT\neventTimeStamp,\nICID,\nHOSTIP,\nHOSTNAME FROM ob_src_ironport WHERE ICID is not NULL and HOSTIP <> \"null\") SERV\nJOIN\n(\nSELECT\nMID,ICID\nFROM ob_src_ironport\nWHERE MID is not NULL and ICID is not NULL\nGROUP BY MID,ICID\n)REL\nON REL.ICID=SERV.ICID\nJOIN\n(\nSELECT\nMID,\nSUM(BYTES) as bytes\nFROM ob_src_ironport\nWHERE bytes is not NULL\nGROUP BY MID\n)TAM\nON TAM.MID=REL.MID\nGROUP BY eventTimeStamp,HOSTIP,HOSTNAME','SELECT\nCONCAT(eventTimeStamp,\"-\",HOSTIP,\"-\",HOSTNAME) as ID,\neventTimeStamp,\nCONCAT(HOSTNAME,\"-[\",HOSTIP,\"]\") as HOSTNAMEIP,\nHOSTIP,\nHOSTNAME,\nCOUNT(1) as TOTAL,\nSUM(BYTES) as BYTES\nFROM\n(\nSELECT\neventTimeStamp,\nICID,\nHOSTIP,\nHOSTNAME','2','ID STRING,\neventTimeStamp TIMESTAMP,\nHOSTNAMEIP STRING,\nHOSTIP STRING,\nHOSTNAME STRING,\nTOTAL BIGINT,\nBYTES BIGINT',NULL,NULL,2),(39,'FROM ob_src_ironport','WHERE MAILFROM <> \"null\" and MID is not NULL  and BYTES is not NULL\nGROUP BY MAILFROM, eventtimestamp,MID)EMI\nJOIN\n(\nSELECT MID\nFROM ob_src_ironport\nWHERE RESPONSE <> \"null\"\nGROUP BY MID\n)REC\nON REC.MID=EMI.MID\nGROUP BY eventTimeStamp,MAILFROM','Cantidad de correos enviados por emisor','top_emisores_awstats','CREATE EXTERNAL TABLE top_emisores_awstats(ID STRING,\neventTimeStamp TIMESTAMP,\nMAILFROM STRING,\nTOTAL BIGINT,\nBYTES BIGINT) STORED BY \'org.elasticsearch.hadoop.hive.EsStorageHandler\' TBLPROPERTIES(\'es.resource\' = \'ob_src_ironport/top_emisores_awstats\', \'es.mapping.id\' = \'ID\', \'es.id.field\' = \'ID\', \'es.index.auto.create\' = \'true\',\'es.nodes\' = \'180.133.240.42,180.133.240.43,180.133.240.44\', \'es.port\' = \'9200\', \'es.mapping.names\' = \'eventtimestamp:@timestamp\')',NULL,'ID','','ob_src_ironport','eventtimestamp','top_emisores_awstats','Ok','2014-07-30 15:52:44','2014-07-30 15:54:37','','',NULL,'','INSERT OVERWRITE TABLE top_emisores_awstats SELECT\nCONCAT(eventTimeStamp,\"-\",MAILFROM) as ID,\neventTimeStamp,\nMAILFROM,\nCOUNT(1) as TOTAL,\nSUM(BYTES) as BYTES\nFROM(\nSELECT\nMID,\neventTimeStamp,\nMAILFROM,\nSUM(bytes) as BYTES FROM ob_src_ironport WHERE MAILFROM <> \"null\" and MID is not NULL  and BYTES is not NULL\nGROUP BY MAILFROM, eventtimestamp,MID)EMI\nJOIN\n(\nSELECT MID\nFROM ob_src_ironport\nWHERE RESPONSE <> \"null\"\nGROUP BY MID\n)REC\nON REC.MID=EMI.MID\nGROUP BY eventTimeStamp,MAILFROM','SELECT\nCONCAT(eventTimeStamp,\"-\",MAILFROM) as ID,\neventTimeStamp,\nMAILFROM,\nCOUNT(1) as TOTAL,\nSUM(BYTES) as BYTES\nFROM(\nSELECT\nMID,\neventTimeStamp,\nMAILFROM,\nSUM(bytes) as BYTES','2','ID STRING,\neventTimeStamp TIMESTAMP,\nMAILFROM STRING,\nTOTAL BIGINT,\nBYTES BIGINT',NULL,NULL,2),(40,'FROM ob_src_ironport','WHERE ICID is not null and MID is not NULL and RID is not NULL and MAILTO <> \"null\"\nGROUP BY eventTimeStamp,MID,mailto\n)RECEP\nJOIN\n(\nSELECT\nMID,\nSUM(bytes) as BYTES\nFROM ob_src_ironport\nWHERE bytes is not NULL\nGROUP BY MID\n)TAM\nON TAM.MID=RECEP.MID\ngroup by eventTimeStamp,MAILTO','Cantidad de correos por receptor','top_receptores_awstats','CREATE EXTERNAL TABLE top_receptores_awstats(ID STRING,\neventTimeStamp TIMESTAMP,\nMAILTO STRING,\nTOTAL BIGINT,\nBYTES BIGINT) STORED BY \'org.elasticsearch.hadoop.hive.EsStorageHandler\' TBLPROPERTIES(\'es.resource\' = \'ob_src_ironport/top_receptores_awstats\', \'es.mapping.id\' = \'ID\', \'es.id.field\' = \'ID\', \'es.index.auto.create\' = \'true\',\'es.nodes\' = \'180.133.240.42,180.133.240.43,180.133.240.44\', \'es.port\' = \'9200\', \'es.mapping.names\' = \'eventtimestamp:@timestamp\')',NULL,'ID','','ob_src_ironport','eventtimestamp','top_receptores_awstats','Ok','2014-07-30 15:56:40','2014-07-30 15:58:56','','',NULL,'','INSERT OVERWRITE TABLE top_receptores_awstats SELECT\nCONCAT(eventTimeStamp,\"-\",MAILTO) as ID,\neventTimeStamp,\nMAILTO,\ncount(1) as TOTAL,\nSUM(BYTES) as BYTES\nFROM\n(\nSELECT\neventTimeStamp,\nMID,\nmailto FROM ob_src_ironport WHERE ICID is not null and MID is not NULL and RID is not NULL and MAILTO <> \"null\"\nGROUP BY eventTimeStamp,MID,mailto\n)RECEP\nJOIN\n(\nSELECT\nMID,\nSUM(bytes) as BYTES\nFROM ob_src_ironport\nWHERE bytes is not NULL\nGROUP BY MID\n)TAM\nON TAM.MID=RECEP.MID\ngroup by eventTimeStamp,MAILTO','SELECT\nCONCAT(eventTimeStamp,\"-\",MAILTO) as ID,\neventTimeStamp,\nMAILTO,\ncount(1) as TOTAL,\nSUM(BYTES) as BYTES\nFROM\n(\nSELECT\neventTimeStamp,\nMID,\nmailto','2','ID STRING,\neventTimeStamp TIMESTAMP,\nMAILTO STRING,\nTOTAL BIGINT,\nBYTES BIGINT',NULL,NULL,2),(41,'FROM ob_src_ironport','WHERE DSNBOUNCE <>\"null\" or DSNDELAY<>\"null\"\nGROUP BY eventTimeStamp,MID,DSNBOUNCE, DSNDELAY\n)ERR\nJOIN\n(\nSELECT\nMID,\nSUM(BYTES) as BYTES\nFROM ob_src_ironport\nWHERE BYTES is not NULL\nGROUP BY MID\n)TAM\nON TAM.MID=ERR.MID\nGROUP BY eventTimeStamp,ERROR','Correos descartados por error','errores_awstats','CREATE EXTERNAL TABLE errores_awstats(ID STRING,\neventTimeStamp TIMESTAMP,\nERROR STRING,\nTOTAL BIGINT,\nBYTES BIGINT) STORED BY \'org.elasticsearch.hadoop.hive.EsStorageHandler\' TBLPROPERTIES(\'es.resource\' = \'ob_src_ironport/errores_awstats\', \'es.mapping.id\' = \'ID\', \'es.id.field\' = \'ID\', \'es.index.auto.create\' = \'true\',\'es.nodes\' = \'180.133.240.42,180.133.240.43,180.133.240.44\', \'es.port\' = \'9200\', \'es.mapping.names\' = \'eventtimestamp:@timestamp\')',NULL,'ID','','ob_src_ironport','eventtimestamp','errores_awstats','Ok','2014-07-30 16:00:50','2014-07-30 16:02:40','','',NULL,'','INSERT OVERWRITE TABLE errores_awstats SELECT\nCONCAT(eventTimeStamp,\"-\",ERROR) as ID,\neventTimeStamp,\nERROR,\nSUM(TOTAL) as TOTAL,\nSUM(BYTES) as BYTES\nFROM\n(SELECT\neventTimeStamp,\nMID,\nCASE \nWHEN DSNBOUNCE=\"null\" THEN DSNDELAY\nELSE DSNBOUNCE\nEND as ERROR,\ncount(1) as TOTAL FROM ob_src_ironport WHERE DSNBOUNCE <>\"null\" or DSNDELAY<>\"null\"\nGROUP BY eventTimeStamp,MID,DSNBOUNCE, DSNDELAY\n)ERR\nJOIN\n(\nSELECT\nMID,\nSUM(BYTES) as BYTES\nFROM ob_src_ironport\nWHERE BYTES is not NULL\nGROUP BY MID\n)TAM\nON TAM.MID=ERR.MID\nGROUP BY eventTimeStamp,ERROR','SELECT\nCONCAT(eventTimeStamp,\"-\",ERROR) as ID,\neventTimeStamp,\nERROR,\nSUM(TOTAL) as TOTAL,\nSUM(BYTES) as BYTES\nFROM\n(SELECT\neventTimeStamp,\nMID,\nCASE \nWHEN DSNBOUNCE=\"null\" THEN DSNDELAY\nELSE DSNBOUNCE\nEND as ERROR,\ncount(1) as TOTAL','2','ID STRING,\neventTimeStamp TIMESTAMP,\nERROR STRING,\nTOTAL BIGINT,\nBYTES BIGINT',NULL,NULL,2),(54,'FROM ob_src_postfix','where MSGID is not NULL and QMGRID is not NULL and USERFROM !=\'null\' GROUP BY MONTH(eventTimeStamp), YEAR(eventTimeStamp)','prueba06082014','prueba06082014','CREATE EXTERNAL TABLE prueba06082014(ID STRING,\nMES INT,ANO INT,\nULTIMO STRING,PRIMERO STRING) STORED BY \'org.elasticsearch.hadoop.hive.EsStorageHandler\' TBLPROPERTIES(\'es.resource\' = \'ob_src_postfix/prueba06082014\', \'es.mapping.id\' = \'ID\', \'es.id.field\' = \'ID\', \'es.index.auto.create\' = \'true\',\'es.nodes\' = \'180.133.240.42,180.133.240.43,180.133.240.44\', \'es.port\' = \'9200\', \'es.mapping.names\' = \'eventtimestamp:@timestamp\')',NULL,'ID','','ob_src_postfix','eventtimestamp','prueba06082014','Ok','2014-08-06 11:39:28','2014-09-03 09:24:56','','','',NULL,'INSERT OVERWRITE TABLE prueba06082014 SELECT\nCONCAT(YEAR(eventTimeStamp),MONTH(eventTimeStamp)) as ID,\nMONTH(eventTimeStamp) as MES,\nYEAR(eventTimeStamp) as ANO,\nMAX(eventTimeStamp) as  ULTIMO,\nMIN(eventTimeStamp) as PRIMERO\n FROM ob_src_postfix where MSGID is not NULL and QMGRID is not NULL and USERFROM !=\'null\' GROUP BY MONTH(eventTimeStamp), YEAR(eventTimeStamp)','SELECT\nCONCAT(YEAR(eventTimeStamp),MONTH(eventTimeStamp)) as ID,\nMONTH(eventTimeStamp) as MES,\nYEAR(eventTimeStamp) as ANO,\nMAX(eventTimeStamp) as  ULTIMO,\nMIN(eventTimeStamp) as PRIMERO\n','1','ID STRING,\nMES INT,ANO INT,\nULTIMO STRING,PRIMERO STRING','admin',NULL,23),(57,'FROM bluecoat_session','GROUP BY ID_sesion,\nclientIP,\nuserCode,\neventTimeStamp_sesion','Calcula las sesiones junto con el total de peticiones de cada una','resumen_sesiones','CREATE EXTERNAL TABLE resumen_sesiones(ID_Sesion STRING,\nClienteIP String,\nuserCode String,\neventTimeStamp_sesion TIMESTAMP,\npeticiones bigint) STORED BY \'org.elasticsearch.hadoop.hive.EsStorageHandler\' TBLPROPERTIES(\'es.resource\' = \'bluecoat_session/resumen_sesiones\', \'es.index.auto.create\' = \'true\',\'es.nodes\' = \'180.133.240.42,180.133.240.43,180.133.240.44\', \'es.port\' = \'9200\', \'es.mapping.names\' = \'eventtimestamp:@timestamp\')','java.sql.SQLException: Error while compiling statement: FAILED: ParseException line 9:21 cannot recognize input near \'eventTimeStamp_sesion\' \';\' \'<EOF>\' in expression specification','ID','','bluecoat_session','','resumen_sesiones','Ok','2014-09-03 09:56:25','2014-09-03 15:47:28','','','',NULL,'INSERT OVERWRITE TABLE resumen_sesiones select \nID_sesion,\nclientIP,\nuserCode,\neventTimeStamp_sesion,\ncount(1) as peticiones FROM bluecoat_session GROUP BY ID_sesion,\nclientIP,\nuserCode,\neventTimeStamp_sesion','select \nID_sesion,\nclientIP,\nuserCode,\neventTimeStamp_sesion,\ncount(1) as peticiones','5','ID_Sesion STRING,\nClienteIP String,\nuserCode String,\neventTimeStamp_sesion TIMESTAMP,\npeticiones bigint','admin','admin',20),(59,'FROM bluecoat_session',') ses\nJOIN (Select ID_sesion,peticiones from resumen_Sesiones) res\nON ses.ID_sesion=res.ID_sesion','Total de peticiones por sesi√≥n','total_sesiones','CREATE EXTERNAL TABLE total_sesiones(ID_peticion String,\nID_sesion String,\nclientIP String,\nuserCode String,\neventTimeStamp_sesion timestamp,\npeticiones bigint,\nsecuenciaPeticion bigint,\neventTimeStamp_peticion timestamp,\nrecurso String) STORED BY \'org.elasticsearch.hadoop.hive.EsStorageHandler\' TBLPROPERTIES(\'es.resource\' = \'bluecoat_session/total_sesiones\', \'es.index.auto.create\' = \'true\',\'es.nodes\' = \'180.133.240.42,180.133.240.43,180.133.240.44\', \'es.port\' = \'9200\', \'es.mapping.names\' = \'eventtimestamp:@timestamp\')',NULL,'ID','','bluecoat_session','','total_sesiones','Ok','2014-09-03 12:53:58','2014-09-03 15:46:37','','','',NULL,'INSERT OVERWRITE TABLE total_sesiones SELECT\nConcat(ses.ID_Sesion,\"-\",secuenciaPeticion) ,\nses.ID_sesion,\nclientIP ,\nuserCode ,\neventTimeStamp_sesion ,\npeticiones ,\nsecuenciaPeticion ,\neventTimeStamp_peticion ,\nrecurso \nFROM \n(Select *  FROM bluecoat_session ) ses\nJOIN (Select ID_sesion,peticiones from resumen_Sesiones) res\nON ses.ID_sesion=res.ID_sesion','SELECT\nConcat(ses.ID_Sesion,\"-\",secuenciaPeticion) ,\nses.ID_sesion,\nclientIP ,\nuserCode ,\neventTimeStamp_sesion ,\npeticiones ,\nsecuenciaPeticion ,\neventTimeStamp_peticion ,\nrecurso \nFROM \n(Select * ','5','ID_peticion String,\nID_sesion String,\nclientIP String,\nuserCode String,\neventTimeStamp_sesion timestamp,\npeticiones bigint,\nsecuenciaPeticion bigint,\neventTimeStamp_peticion timestamp,\nrecurso String',NULL,NULL,6);
/*!40000 ALTER TABLE `metrica_batch` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `metrica_on_line`
--

DROP TABLE IF EXISTS `metrica_on_line`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `metrica_on_line` (
  `id` bigint(20) NOT NULL AUTO_INCREMENT,
  `es_campos_id` varchar(255) DEFAULT NULL,
  `es_index` varchar(255) DEFAULT NULL,
  `es_type` varchar(255) DEFAULT NULL,
  `estado` varchar(255) DEFAULT NULL,
  `fecha_creacion` datetime DEFAULT NULL,
  `fecha_ult_modif` datetime DEFAULT NULL,
  `is_created` bit(1) DEFAULT NULL,
  `is_updated` bit(1) DEFAULT NULL,
  `on_line_metric_desc` varchar(255) DEFAULT NULL,
  `on_line_metric_name` varchar(255) DEFAULT NULL,
  `usuario_creacion` varchar(255) DEFAULT NULL,
  `usuario_modificacion` varchar(255) DEFAULT NULL,
  `version` int(11) DEFAULT NULL,
  `stream_cep` bigint(20) DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `FK_abql4japs9as575xq249m13y3` (`stream_cep`),
  CONSTRAINT `FK_abql4japs9as575xq249m13y3` FOREIGN KEY (`stream_cep`) REFERENCES `stream_cep` (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `metrica_on_line`
--

LOCK TABLES `metrica_on_line` WRITE;
/*!40000 ALTER TABLE `metrica_on_line` DISABLE KEYS */;
/*!40000 ALTER TABLE `metrica_on_line` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `metrica_on_line_hs_query_cep`
--

DROP TABLE IF EXISTS `metrica_on_line_hs_query_cep`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `metrica_on_line_hs_query_cep` (
  `metrica_on_line` bigint(20) NOT NULL,
  `hs_query_cep` bigint(20) NOT NULL,
  PRIMARY KEY (`metrica_on_line`,`hs_query_cep`),
  UNIQUE KEY `UK_a5urtbxsq8euac1t2x9787lfn` (`hs_query_cep`),
  KEY `FK_a5urtbxsq8euac1t2x9787lfn` (`hs_query_cep`),
  KEY `FK_tawt96yluqapnjmowqwxl31m6` (`metrica_on_line`),
  CONSTRAINT `FK_tawt96yluqapnjmowqwxl31m6` FOREIGN KEY (`metrica_on_line`) REFERENCES `metrica_on_line` (`id`),
  CONSTRAINT `FK_a5urtbxsq8euac1t2x9787lfn` FOREIGN KEY (`hs_query_cep`) REFERENCES `query_cep` (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `metrica_on_line_hs_query_cep`
--

LOCK TABLES `metrica_on_line_hs_query_cep` WRITE;
/*!40000 ALTER TABLE `metrica_on_line_hs_query_cep` DISABLE KEYS */;
/*!40000 ALTER TABLE `metrica_on_line_hs_query_cep` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `origen_estructurado`
--

DROP TABLE IF EXISTS `origen_estructurado`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `origen_estructurado` (
  `id` bigint(20) NOT NULL AUTO_INCREMENT,
  `is_kafka_online` bit(1) DEFAULT NULL,
  `kafka_topic` varchar(255) DEFAULT NULL,
  `topology_name` varchar(255) DEFAULT NULL,
  `version` int(11) DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=6 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `origen_estructurado`
--

LOCK TABLES `origen_estructurado` WRITE;
/*!40000 ALTER TABLE `origen_estructurado` DISABLE KEYS */;
INSERT INTO `origen_estructurado` VALUES (1,'','ob_src_postfix','ob_src_postfix',1),(2,'','ob_src_ironport','ob_src_ironport',1),(3,'','ob_src_amavis','ob_src_amavis',1),(4,'','ob_src_bluecoat','ob_src_bluecoat',1),(5,'','bluecoat_session','bluecoat_session',1);
/*!40000 ALTER TABLE `origen_estructurado` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `query_cep`
--

DROP TABLE IF EXISTS `query_cep`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `query_cep` (
  `id` bigint(20) NOT NULL AUTO_INCREMENT,
  `error` longblob,
  `es_campos_geo` varchar(255) DEFAULT NULL,
  `es_id` varchar(255) DEFAULT NULL,
  `group_by` longblob,
  `has_callback` bit(1) DEFAULT NULL,
  `output_field_names` longblob,
  `output_field_user` longblob,
  `output_stream` longblob,
  `query_cep_id` varchar(255) DEFAULT NULL,
  `query_definition` longblob,
  `query_final` longblob,
  `query_name` varchar(255) DEFAULT NULL,
  `to_remove` bit(1) DEFAULT NULL,
  `to_update_cep` bit(1) DEFAULT NULL,
  `version` int(11) DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `query_cep`
--

LOCK TABLES `query_cep` WRITE;
/*!40000 ALTER TABLE `query_cep` DISABLE KEYS */;
/*!40000 ALTER TABLE `query_cep` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `stream_cep`
--

DROP TABLE IF EXISTS `stream_cep`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `stream_cep` (
  `id` bigint(20) NOT NULL AUTO_INCREMENT,
  `error` longblob,
  `stream_cep_id` varchar(255) DEFAULT NULL,
  `stream_fields` longblob,
  `stream_final` longblob,
  `stream_name` varchar(255) DEFAULT NULL,
  `to_remove` bit(1) DEFAULT NULL,
  `to_update_cep` bit(1) DEFAULT NULL,
  `version` int(11) DEFAULT NULL,
  `origen_estructurado` bigint(20) DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `FK_ak91yefvgku4n5pwaw1h6t1x3` (`origen_estructurado`),
  CONSTRAINT `FK_ak91yefvgku4n5pwaw1h6t1x3` FOREIGN KEY (`origen_estructurado`) REFERENCES `origen_estructurado` (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `stream_cep`
--

LOCK TABLES `stream_cep` WRITE;
/*!40000 ALTER TABLE `stream_cep` DISABLE KEYS */;
/*!40000 ALTER TABLE `stream_cep` ENABLE KEYS */;
UNLOCK TABLES;
/*!40103 SET TIME_ZONE=@OLD_TIME_ZONE */;

/*!40101 SET SQL_MODE=@OLD_SQL_MODE */;
/*!40014 SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS */;
/*!40014 SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS */;
/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
/*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */;

-- Dump completed on 2014-09-24 10:47:43
